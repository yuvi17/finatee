if (self.CavalryLogger) { CavalryLogger.start_js(["OUBiJ"]); }

__d("ChatReliabilityEvents",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ERROR:"error",CHANNEL_DISCONNECT:"channel_disconnect",CHANNEL_CONNECT:"channel_connect",CHANNEL_INIT:"channel_init",CHANNEL_NOCONFIG:"channel_noconfig",CHANNEL_HISTORY_INVALID:"channel_history_invalid",CHANNEL_STALLED:"channel_stalled",MESSAGE_RECEIVED:"msg_received"};},null);
__d("ChatSidebarSections",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={MORE_ONLINE_FRIENDS:"more_online_friends",MORE_ONLINE_COWORKERS:"more_online_coworkers",OFFLINE_USERS:"offline_users",ORDERED_LIST:"ordered_list",ORDERED_COWORKERS:"ordered_coworkers",TYPEAHEAD:"typeahead",NOW_PINNED_LIST:"now_pinned_list"};},null);
__d("MercuryTypeaheadConstants",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={COMPOSER_FRIENDS_MAX:4,COMPOSER_FB4C_MAX:4,COMPOSER_NON_FRIENDS_MAX:2,COMPOSER_SHOW_MORE_LIMIT:2,COMPOSER_THREADS_INITIAL_LIMIT:2,COMPOSER_CHATTAB_MAX:5,COMPOSER_PAGES_MAX:4,COMPOSER_WM_MAX:18,USER_TYPE:"user",PAGE_TYPE:"page",THREAD_TYPE:"thread",HEADER_TYPE:"header",FRIEND_TYPE:"friend",NON_FRIEND_TYPE:"non_friend",FB4C_TYPE:"fb4c",MEETING_ROOM_PAGE_TYPE:"meeting_room_page",COMMERCE_PAGE_TYPE:"commerce_page",VALID_EMAIL:"^([A-Z0-9._\u0025+-]+\u0040((?!facebook\\.com))[A-Z0-9.-]+\\.[A-Z]{2,4}|(([A-Z._\u0025+-]+[A-Z0-9._\u0025+-]*)|([A-Z0-9._\u0025+-]+[A-Z._\u0025+-]+[A-Z0-9._\u0025+-]*))\u0040(?:facebook\\.com))$"};},null);
__d("SidebarType",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={SIDEBAR:"sidebar",BUDDYLIST:"buddylist",BUDDYLIST_NUB:"buddylist_nub"};},null);
__d('AsyncLoader',['AsyncRequest','BaseAsyncLoader'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){this._endpoint=i;this._type=j;}Object.assign(h.prototype,c('BaseAsyncLoader').prototype);h.prototype.send=function(i,j,k,l,m){new (c('AsyncRequest'))(i).setData({ids:j}).setHandler(l).setErrorHandler(m).setAllowCrossPageTransition(true).setMethod('GET').setReadOnly(true).send();};f.exports=h;},null);
__d('AvailableListConstants',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={ON_AVAILABILITY_CHANGED:'buddylist/availability-changed',ON_UPDATE_ERROR:'buddylist/update-error',ON_UPDATED:'buddylist/updated',ON_CHAT_NOTIFICATION_CHANGED:'chat-notification-changed',OFFLINE:0,IDLE:1,ACTIVE:2,MOBILE:3,WEB_STATUS:'webStatus',FB_APP_STATUS:'fbAppStatus',MESSENGER_STATUS:'messengerStatus',OTHER_STATUS:'otherStatus',STATUS_ACTIVE:'active',STATUS_IDLE:'idle',STATUS_OFFLINE:'offline'};f.exports=h;},null);
__d('LastActiveTimes',['fbt','ServerTime'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={};function j(n){if(!n||n<0)return '';var o=c('ServerTime').get()/1000-n,p=Math.floor(o/60),q=Math.floor(p/60),r=Math.floor(q/24);if(p<=1){return h._("{count}m",[h.param('count',1)]);}else if(p<60){return h._("{count}m",[h.param('count',p)]);}else if(q<24){return h._("{count}h",[h.param('count',q)]);}else if(r<3){return h._("{count}d",[h.param('count',r)]);}else return '';}function k(n,o){if(!(n in i)||i[n]<o)i[n]=o;}function l(n){if(n in i){return i[n];}else return 0;}var m={update:function(n){for(var o in n)k(o,n[o]);},getShortDisplay:function(n){return j(l(n));},get:function(n){return l(n);},getDebugData:function(){return i;}};f.exports=m;},null);
__d('PresenceUtil',['CurrentUser','randomInt'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('randomInt')(0,4294967295)+1;function i(){return h;}function j(){return c('CurrentUser').isLoggedInNow();}f.exports={getSessionID:i,hasUserCookie:j};},null);
__d('PresencePrivacy',['Arbiter','AsyncRequest','ChannelConstants','CurrentUser','PresencePrivacyInitialData','JSLogger','PresenceUtil'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h='/ajax/chat/privacy/settings.php',i='/ajax/chat/privacy/online_policy.php',j='/ajax/chat/privacy/visibility.php',k='friend_visibility',l='visibility',m='online_policy',n=babelHelpers['extends']({},c('PresencePrivacyInitialData').privacyData),o=c('PresencePrivacyInitialData').visibility,p=babelHelpers['extends']({},c('PresencePrivacyInitialData').privacyData),q=o,r=c('PresencePrivacyInitialData').onlinePolicy,s=r,t=[],u=false;function v(){return c('JSLogger').create('blackbird');}var w=Object.assign(new (c('Arbiter'))(),{WHITELISTED:1,BLACKLISTED:-1,UNLISTED:0,ONLINE:1,OFFLINE:0,ONLINE_TO_WHITELIST:0,ONLINE_TO_BLACKLIST:1});function x(ja){var ka;for(ka in ja){var la=ja[ka];if(ka==c('CurrentUser').getID()){v().error('set_viewer_visibility');throw new Error("Invalid to set current user's visibility");}switch(la){case w.WHITELISTED:case w.BLACKLISTED:case w.UNLISTED:break;default:v().error('set_invalid_friend_visibility',{id:ka,value:la});throw new Error("Invalid state: "+la);}}for(ka in ja)n[ka]=ja[ka];w.inform('privacy-changed');}function y(ja,ka){var la={};la[ja]=ka;x(la);}function z(ja){switch(ja){case w.ONLINE:case w.OFFLINE:break;default:v().error('set_invalid_visibility',{value:ja});throw new Error("Invalid visibility: "+ja);}o=ja;w.inform('privacy-changed');w.inform('privacy-user-presence-changed');}function aa(ja){switch(ja){case w.ONLINE_TO_WHITELIST:case w.ONLINE_TO_BLACKLIST:break;default:throw new Error("Invalid default online policy: "+ja);}r=ja;w.inform('privacy-user-presence-changed');w.inform('privacy-changed');}function ba(ja,ka){u=true;ja.send();}function ca(ja,ka){t.push({request:ja,data:ka});if(!u){var la=t.shift();ba(la.request,la.data);}}function da(ja,ka){var la=ja.type;if(la===k){var ma=ka.payload.user_availabilities;if(!Array.isArray(ma)){w.inform('privacy-availability-changed',{user_availabilities:ma});for(var na in ja.settings)p[na]=ja.settings[na];}}else{if(la===l){q=ja.visibility;}else if(la===m)s=ja.online_policy;w.inform('privacy-user-presence-response');}v().log('set_update_response',{data:ja,response:ka});}function ea(ja,ka){if(o!==q)z(q);if(r!==s)aa(s);Object.assign(n,p);w.inform('privacy-changed');t=[];v().log('set_error_response',{data:ja,response:ka});}function fa(ja){u=false;if(t.length>0){var ka=t.shift();ba(ka.request,ka.data);}}function ga(ja,ka){if(c('PresenceUtil')!=null){var la=ja.getData();la.window_id=c('PresenceUtil').getSessionID();ja.setData(la);}ja.setHandler(da.bind(this,ka)).setErrorHandler(ea.bind(this,ka)).setTransportErrorHandler(ea.bind(this,ka)).setFinallyHandler(fa.bind(this)).setAllowCrossPageTransition(true);return ja;}function ha(ja,ka,la){return ga(new (c('AsyncRequest'))(ja).setData(ka),la);}function ia(ja,ka){var la=ka.obj;if(la.viewer_id!=c('CurrentUser').getID()){v().error('invalid_viewer_for_channel_message',{type:ja,data:ka});throw new Error("Viewer got from the channel is not the real viewer");}if(la.window_id===c('PresenceUtil').getSessionID())return;var ma=la.data;if(la.event=='access_control_entry'){ma.target_ids.forEach(function(oa){y(oa,ma.setting);p[oa]=ma.setting;});}else{if(la.event=='visibility_update'){var na=!!ma.visibility?w.ONLINE:w.OFFLINE;z(na);q=na;}else if(la.event=='online_policy_update'){aa(ma.online_policy);s=ma.online_policy;}w.inform('privacy-user-presence-response');}v().log('channel_message_received',{data:ka.obj});}Object.assign(w,{WHITELISTED:1,BLACKLISTED:-1,UNLISTED:0,ONLINE:1,OFFLINE:0,ONLINE_TO_WHITELIST:0,ONLINE_TO_BLACKLIST:1,init:function(ja,ka,la){},setVisibility:function(ja){q=o;z(ja);var ka={visibility:ja},la={type:l,visibility:ja},ma=ha(j,ka,la);ca(ma,la);v().log('set_visibility',{data:ka});return ja;},getVisibility:function(){return o;},setOnlinePolicy:function(ja){s=r;aa(ja);var ka={online_policy:ja},la={type:m,online_policy:ja},ma=ha(i,ka,la);ca(ma,la);v().log('set_online_policy',{data:ka});return ja;},getOnlinePolicy:function(){return r;},getFriendVisibility:function(ja){return n[ja]||w.UNLISTED;},isUserOffline:function(){return this.getVisibility()===w.OFFLINE;},allows:function(ja){if(this.isUserOffline())return false;var ka=this.getOnlinePolicy();return ka===w.ONLINE_TO_WHITELIST?n[ja]==w.WHITELISTED:n[ja]!=w.BLACKLISTED;},setFriendsVisibility:function(ja,ka){if(ja.length>0){var la={};for(var ma=0;ma<ja.length;ma++){var na=ja[ma];p[na]=n[na];la[na]=ka;}x(la);var oa=ka;if(oa==w.UNLISTED)oa=p[ja[0]];var pa={users:ja,setting:ka,setting_type:oa},qa={type:k,settings:la},ra=ha(h,pa,qa);ca(ra,qa);v().log('set_friend_visibility',{data:pa});}return ka;},setFriendVisibilityMap:function(ja,ka){for(var la in ja)p[la]=n[la];x(ja);var ma={type:k,settings:ja};ca(ga(ka,ma),ma);v().log('set_friend_visibility_from_map',{data:ja});},allow:function(ja){if(this.allows(ja)){v().error('allow_already_allowed');throw new Error("allow() should only be called for users that "+"are not already allowed");}if(this.getVisibility()===w.OFFLINE){v().error('allow_called_while_offline');throw new Error("allow() should only be called when the user is already online");}var ka=this.getOnlinePolicy()===w.ONLINE_TO_WHITELIST?w.WHITELISTED:w.UNLISTED;return this.setFriendsVisibility([ja],ka);},disallow:function(ja){if(!this.allows(ja)){v().error('disallow_already_disallowed');throw new Error("disallow() should only be called for users that "+"are not already disallowed");}if(this.getVisibility()===w.OFFLINE){v().error('disallow_called_while_offline');throw new Error("disallow() should only be called when the user is already online");}var ka=this.getOnlinePolicy()===w.ONLINE_TO_BLACKLIST?w.BLACKLISTED:w.UNLISTED;return this.setFriendsVisibility([ja],ka);},getBlacklist:function(){var ja=[];for(var ka in n)if(n[ka]===w.BLACKLISTED)ja.push(ka);return ja;},getWhitelist:function(){var ja=[];for(var ka in n)if(n[ka]===w.WHITELISTED)ja.push(ka);return ja;},getMapForTest:function(){return n;},setMapForTest:function(ja){n=ja;}});w.inform('privacy-changed');w.inform('privacy-user-presence-changed',c('Arbiter').BEHAVIOR_STATE);v().log('initialized',{visibility:o,policy:r});c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(ja,ka){ka.presence_privacy={initial:c('PresencePrivacyInitialData').privacyData,current:n};});c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('privacy_changed'),ia.bind(this));c('Arbiter').subscribe(c('ChannelConstants').ON_CONFIG,function(ja,ka){var la=ka.getConfig('visibility',null);if(la!==null&&typeof la!=='undefined'){var ma=la?w.ONLINE:w.OFFLINE;z(ma);v().log('config_visibility',{vis:ma});}}.bind(this));f.exports=w;},null);
__d('ChatVisibility',['Arbiter','JSLogger','PresencePrivacy'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={isOnline:function(){return c('PresencePrivacy').getVisibility()===c('PresencePrivacy').ONLINE;},hasBlackbirdEnabled:function(){return this.isVisibleToMostFriends()||this.isVisibleToSomeFriends();},isVisibleToMostFriends:function(){return c('PresencePrivacy').getOnlinePolicy()===c('PresencePrivacy').ONLINE_TO_BLACKLIST&&c('PresencePrivacy').getBlacklist().length>0;},isVisibleToSomeFriends:function(){return c('PresencePrivacy').getOnlinePolicy()===c('PresencePrivacy').ONLINE_TO_WHITELIST&&c('PresencePrivacy').getWhitelist().length>0;},goOnline:function(i){if(c('PresencePrivacy').getVisibility()===c('PresencePrivacy').OFFLINE){c('JSLogger').create('blackbird').log('chat_go_online');c('PresencePrivacy').setVisibility(c('PresencePrivacy').ONLINE);c('Arbiter').inform('chat-visibility/go-online');}i&&i();},goOffline:function(i){if(c('PresencePrivacy').getVisibility()===c('PresencePrivacy').ONLINE){c('JSLogger').create('blackbird').log('chat_go_offline');c('PresencePrivacy').setVisibility(c('PresencePrivacy').OFFLINE);c('Arbiter').inform('chat-visibility/go-offline');}i&&i();},toggleVisibility:function(){if(h.isOnline()){h.goOffline();}else h.goOnline();}};f.exports=h;},null);
__d('PresenceStatus',['ArbiterMixin','AvailableListConstants','BanzaiODS','ChatVisibility','CurrentUser','LastActiveTimes','PresencePrivacy','ServerTime','createObjectFrom','debounceAcrossTransitions'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();c('BanzaiODS').setEntitySample('presence',.0001);var h={},i={},j={},k=Object.assign({},c('ArbiterMixin')),l=c('debounceAcrossTransitions')(function(){return k.inform('change');},0);Object.assign(k,{resetPresenceData:function(){h={};i={};},reset:function(){k.resetPresenceData();j={};},get:function(m){if(m==c('CurrentUser').getID())return c('ChatVisibility').isOnline()?c('AvailableListConstants').ACTIVE:c('AvailableListConstants').OFFLINE;var n=c('AvailableListConstants').OFFLINE;if(m in h)n=h[m];if(!c('PresencePrivacy').allows(m))n=c('AvailableListConstants').OFFLINE;return n;},getCapabilities:function(m){var n=k.get(m);if(n==c('AvailableListConstants').OFFLINE)return 0;var o=i[m];return o?o:0;},isPlayingCanvasGameUser:function(m){return !!j[m];},getGroup:function(m){return m.some(function(n){if(n==c('CurrentUser').getID())return false;return k.get(n)===c('AvailableListConstants').ACTIVE;})?c('AvailableListConstants').ACTIVE:c('AvailableListConstants').OFFLINE;},set:function(m,n,o,p,q,r){if(m==c('CurrentUser').getID())return false;var s;if(n!==null&&n!==undefined){n=n==c('AvailableListConstants').ACTIVE?c('AvailableListConstants').ACTIVE:c('AvailableListConstants').OFFLINE;var t=k.get(m);s=t!=n;if(s&&t==c('AvailableListConstants').ACTIVE||n==c('AvailableListConstants').ACTIVE){var u={};u[m]=c('ServerTime').get()/1000;c('LastActiveTimes').update(u);}h[m]=n;}var v=false;if(q){v=k.getCapabilities(m)!=q;i[m]=q;}var w=s||v;if(w&&!r)l();return w;},setPlayingCanvasGameFriends:function(m){j=c('createObjectFrom')(m);},getOnlineIDs:function(){var m,n=[];for(m in h)if(k.get(m)===c('AvailableListConstants').ACTIVE)n.push(m);return n;},getOnlineCount:function(){return k.getOnlineIDs().length;},getPresenceStats:function(){var m=0,n=0,o=0;for(var p in h){m+=1;switch(k.get(p)){case c('AvailableListConstants').OFFLINE:n+=1;break;case c('AvailableListConstants').ACTIVE:o+=1;break;default:break;}}return {total:m,offline:n,active:o};},getDebugInfo:function(m){return {id:m,presence:h[m]};},getAllDebugInfo:function(){return {presence:h};},setMulti:function(m,n){var o=false;for(var p in m)k.set(p,m[p].a,false,n,m[p].c,true)&&(o=true);if(o)l();},setMultiChatproxy:function(m){var n={};for(var o in m){if(m[o].lat)n[o]=m[o].lat;var p=m[o].p;if(p!==undefined)k.set(o,p,false,'chatproxy',m[o].vc,true);}c('LastActiveTimes').update(n);l();},setMultiActive:function(m,n){var o=false;m.forEach(function(p){k.set(p,c('AvailableListConstants').ACTIVE,false,n,null,true)&&(o=true);});if(o)l();}});f.exports=k;},null);
__d('ChatproxyPresence',['Arbiter','AvailableListConstants','AvailableListInitialData','ChannelConstants','CurrentUser','LastActiveTimes','PresenceStatus','debounceAcrossTransitions'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this.$ChatproxyPresence1=i;this.$ChatproxyPresence2=false;this.$ChatproxyPresence3=c('AvailableListInitialData').chatNotif;var j=c('AvailableListInitialData').activeList,k=c('AvailableListInitialData').lastActiveTimes;if(j)c('PresenceStatus').setMultiActive(j,'available_list_active');if(k&&!Array.isArray(k))c('LastActiveTimes').update(k);}h.prototype.subscribe=function(){'use strict';c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('chatproxy-presence'),this.updatePresenceInfo.bind(this));c('Arbiter').subscribe(c('ChannelConstants').ON_INVALID_HISTORY,function(){this.$ChatproxyPresence2=true;}.bind(this));};h.prototype.updatePresenceInfo=function(i,j){'use strict';if(this.$ChatproxyPresence2){this.$ChatproxyPresence2=false;c('PresenceStatus').resetPresenceData();}j=j.obj;var k=j.buddyList;c('PresenceStatus').setMultiChatproxy(k);var l=false;if(j.chatNotif!==undefined)l=this.$ChatproxyPresence3!==j.chatNotif;if(l)this.$ChatproxyPresence3=j.chatNotif;if(j.gamers)c('PresenceStatus').setPlayingCanvasGameFriends(j.gamers);if(l)this.$ChatproxyPresence1(c('AvailableListConstants').ON_CHAT_NOTIFICATION_CHANGED,this.$ChatproxyPresence3);c('debounceAcrossTransitions')(function(){this.$ChatproxyPresence1(c('AvailableListConstants').ON_AVAILABILITY_CHANGED);}.bind(this),0)();};h.prototype.getWebChatNotification=function(){'use strict';return this.$ChatproxyPresence3;};f.exports=h;},null);
__d('ChatConfig',['ChatConfigInitialData'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={},i={get:function(j,k){return j in h?h[j]:k;},set:function(j){if(arguments.length>1){var k={};k[j]=arguments[1];j=k;}Object.assign(h,j);},getDebugInfo:function(){return h;}};i.set(c('ChatConfigInitialData'));f.exports=i;},null);
__d('ExplicitRegistrationDispatcherUtils',['ErrorUtils','FluxInternalConfig','emptyFunction','monitorCodeUse','setImmediate'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('emptyFunction'),i=false,j=c('emptyFunction');f.exports={guessStoreName:h,warn:j,inlineRequiresEnabled:i};},null);
__d('ExplicitRegistrationDispatcher',['Dispatcher_DEPRECATED','ExplicitRegistrationDispatcherUtils','setImmediate'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('Dispatcher_DEPRECATED'));i=h&&h.prototype;function j(k){var l=k.strict;i.constructor.call(this);this.$ExplicitRegistrationDispatcher5=l;this.$ExplicitRegistrationDispatcher4=1;this.$ExplicitRegistrationDispatcher1={};this.$ExplicitRegistrationDispatcher2={};this.$ExplicitRegistrationDispatcher3={};}j.prototype.explicitlyRegisterStore=function(k){var l=k.getDispatchToken(),m=this.$ExplicitRegistrationDispatcher2[l];this.$ExplicitRegistrationDispatcher3[m]=true;};j.prototype.explicitlyRegisterStores=function(k){k.forEach(function(l){return this.explicitlyRegisterStore(l);}.bind(this));};j.prototype.register=function(k){var l=this.$ExplicitRegistrationDispatcher4++;this.$ExplicitRegistrationDispatcher1[l]=k;this.$ExplicitRegistrationDispatcher3[l]=false;var m=i.register.call(this,this.$ExplicitRegistrationDispatcher7.bind(this,l));this.$ExplicitRegistrationDispatcher2[m]=l;return m;};j.prototype.$ExplicitRegistrationDispatcher7=function(k,l){if(this.$ExplicitRegistrationDispatcher3[k]||!this.$ExplicitRegistrationDispatcher5)this.$ExplicitRegistrationDispatcher1[k](l);};f.exports=j;},null);
__d('ChatDispatcher',['ExplicitRegistrationDispatcher'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('ExplicitRegistrationDispatcher'));i=h&&h.prototype;function j(){h.apply(this,arguments);}f.exports=new j({strict:false});},null);
__d('ChatReliabilityTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(){this.clear();}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:ChatReliabilityLoggerConfig',this.$ChatReliabilityTypedLogger1,c('Banzai').BASIC);};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:ChatReliabilityLoggerConfig',this.$ChatReliabilityTypedLogger1,c('Banzai').VITAL);};h.prototype.clear=function(){this.$ChatReliabilityTypedLogger1={};return this;};h.prototype.updateData=function(j){this.$ChatReliabilityTypedLogger1=babelHelpers['extends']({},this.$ChatReliabilityTypedLogger1,j);return this;};h.prototype.setEvent=function(j){this.$ChatReliabilityTypedLogger1.event=j;return this;};h.prototype.setEventData=function(j){this.$ChatReliabilityTypedLogger1.event_data=j;return this;};var i={event:true,event_data:true};f.exports=h;},null);
__d('ChatReliabilityInstrumentation',['ChatReliabilityEvents','ChatReliabilityTypedLogger','MercuryConfig'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=function(event,j){if(!c('MercuryConfig').EnableReliabilityLogging)return;new (c('ChatReliabilityTypedLogger'))().setEvent(event).setEventData(j).log();},i={logERROR:function(j){h(c('ChatReliabilityEvents').ERROR,j);},logCHANNEL_DISCONNECT:function(j){h(c('ChatReliabilityEvents').CHANNEL_DISCONNECT,j);},logCHANNEL_CONNECT:function(j){h(c('ChatReliabilityEvents').CHANNEL_CONNECT,j);},logCHANNEL_HISTORY_INVALID:function(j){h(c('ChatReliabilityEvents').CHANNEL_HISTORY_INVALID,j);},logMESSAGE_RECEIVED:function(j){h(c('ChatReliabilityEvents').MESSAGE_RECEIVED,j);},logCHANNEL_STALLED:function(j){h(c('ChatReliabilityEvents').CHANNEL_STALLED,j);},logCHANNEL_INIT:function(j){h(c('ChatReliabilityEvents').CHANNEL_INIT,j);},logCHANNEL_NOCONFIG:function(j){h(c('ChatReliabilityEvents').CHANNEL_NOCONFIG,j);}};f.exports=i;},null);
__d('PresenceStatusActionTypes',['keyMirror'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=c('keyMirror')({AVAILABILITY_CHANGED:null});},null);
__d("TypingStates",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={INACTIVE:0,TYPING:1,QUITTING:2};f.exports=h;},null);
__d('AvailableList',['Arbiter','ArbiterMixin','AsyncRequest','AvailableListConstants','BanzaiODS','Bootloader','ChannelConstants','ChatConfig','ChatDispatcher','ChatproxyPresence','ChatReliabilityInstrumentation','ChatVisibility','CurrentUser','ErrorUtils','JSLogger','LastActiveTimes','PresencePrivacy','PresenceStatus','PresenceStatusActionTypes','Run','ServerTime','ShortProfiles','TypingStates','debounceAcrossTransitions','emptyFunction','requireWeak'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();c('BanzaiODS').setEntitySample('presence',.0001);var h=babelHelpers['extends']({},c('AvailableListConstants'),c('ArbiterMixin'));h.subscribe([c('AvailableListConstants').ON_AVAILABILITY_CHANGED,c('AvailableListConstants').ON_UPDATE_ERROR],function(p,q){c('Arbiter').inform(p,q);});var i=c('debounceAcrossTransitions')(function(){h.inform(c('AvailableListConstants').ON_AVAILABILITY_CHANGED);c('ChatDispatcher').dispatch({type:c('PresenceStatusActionTypes').AVAILABILITY_CHANGED});},0);function j(p,q,r,s,t){if(p===c('CurrentUser').getID())return;var u=c('PresenceStatus').set(p,q,r,s,t);if(u){var v=c('debounceAcrossTransitions')(function(){h.inform(c('AvailableListConstants').ON_AVAILABILITY_CHANGED,p);c('ChatDispatcher').dispatch({type:c('PresenceStatusActionTypes').AVAILABILITY_CHANGED,id:p});},0);v();}}function k(p){var q=p.payload.availability||{};for(var r in q)j(r&&r.toString(),q[r].a,true,'mercury_tabs',q[r].c);}function l(p){var q=h.getDebugInfo(p),r=q.presence==c('AvailableListConstants').ACTIVE;new (c('AsyncRequest'))('/ajax/mercury/tabs_presence.php').setData({target_id:p,to_online:r,presence_source:q.overlaySource,presence_time:q.overlayTime}).setHandler(k).setErrorHandler(c('emptyFunction')).setAllowCrossPageTransition(true).send();}function m(p,q){q.chat_config=c('ChatConfig').getDebugInfo();q.available_list_debug_info={count:c('PresenceStatus').getOnlineIDs().length};}var n=undefined;try{n=new (c('ChatproxyPresence'))(function(event){h.inform(event);});n.subscribe();}catch(o){c('ErrorUtils').reportError&&c('ErrorUtils').reportError(o,false);c('ChatReliabilityInstrumentation').logERROR(o.getMessage());}Object.assign(h,{getChatproxyPresenceObject:function(){return n;},get:function(p){return c('PresenceStatus').get(p);},updateForID:function(p){l(p);if(c('PresencePrivacy').getVisibility()==c('PresencePrivacy').ONLINE)c('Run').onAfterLoad(function(){return (c('Bootloader').loadModules(["ChannelManager","ChannelTransport"],function(q,r){r.sendAdditionalBuddyRequest(q.getCompleteConfig(),p);},'AvailableList'));});},getWebChatNotification:function(){return n&&n.getWebChatNotification();},isReady:function(){return !!n;},set:function(p,q,r,s){j(p,q,true,r,s);},getDebugInfo:function(p){var q=c('PresenceStatus').getDebugInfo(p),r=c('ShortProfiles').getNow(p);if(r)q.name=r.name;return q;}});c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,m);c('PresencePrivacy').subscribe(['privacy-changed','privacy-availability-changed','privacy-user-presence-response'],i);c('requireWeak')('ChannelConnection',function(p){return (p.subscribe([p.CONNECTED,p.RECONNECTING,p.SHUTDOWN,p.MUTE_WARNING,p.UNMUTE_WARNING],i));});c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('buddylist_overlay'),function(p,q){var r={},s=q.obj.overlay;for(var t in s){h.set(t,s[t].a,s[t].s||'channel',s[t].vc);if(s[t].la)r[t]=s[t].la;}c('LastActiveTimes').update(r);});c('Arbiter').subscribe([c('ChannelConstants').getArbiterType('typ'),c('ChannelConstants').getArbiterType('ttyp')],function(p,q){var r=q.obj;if(r.st===c('TypingStates').TYPING){var s=r.from;if(c('ChatVisibility').isOnline()){c('BanzaiODS').bumpEntityKey('presence','stale_presence_check_typing');var t=c('PresenceStatus').get(s);if(t!=c('AvailableListConstants').ACTIVE){var u=c('LastActiveTimes').get(s)*1000,v=c('ServerTime').get();if(!u){c('BanzaiODS').bumpEntityKey('presence','no_detailed_presence_typing');}else if(v-u>5*60*1000){var w='stale_presence_typing',x=v-u;if(x<10*60*1000){w+='600';}else if(x<60*60*1000)w+='3600';c('BanzaiODS').bumpEntityKey('presence',w);}}}h.set(s&&s.toString(),c('AvailableListConstants').ACTIVE,'channel-typing');}});c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('messaging'),function(p,q){if(!c('ChatVisibility').isOnline())return;var r=q.obj;if(r.message&&r.message.timestamp&&r.message.sender_fbid){var s=c('ServerTime').get(),t=r.message.timestamp;if(s-t<2*60*1000){c('BanzaiODS').bumpEntityKey('presence','stale_presence_check');var u=r.message.sender_fbid,v=c('PresenceStatus').get(u);if(v==c('AvailableListConstants').ACTIVE)return;var w=c('LastActiveTimes').get(u)*1000;if(!w){c('BanzaiODS').bumpEntityKey('presence','no_detailed_presence');}else if(t-w>5*60*1000){var x='stale_presence',y=t-w;if(y<10*60*1000){x+='600';}else if(y<60*60*1000)x+='3600';c('BanzaiODS').bumpEntityKey('presence',x);}}}});f.exports=h;},null);
__d('ChatHovercard',['Arbiter','AsyncLoader','Bootloader','JSLogger','debounce'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=5,i=new (c('AsyncLoader'))('/ajax/chat/hovercard/sidebar.php','hover'),j=c('JSLogger').create('chat_hovercard');c('Arbiter').subscribe('Hovercard/dirty',i.reset.bind(i));function k(o,p){i.get(o,function(q){setTimeout(function(){if(!q){j.error('fetch_failure',{id:o});return;}c('Bootloader').loadModules(["Hovercard"],function(r){var s=r.getDialog(q);if(!s){j.error('no_hovercard',{id:o,endpoint:q});return;}if(o==p.getActiveID())p.showHovercard(o,s);},'ChatHovercard');},0);});}function l(o,p){var q=[];function r(u){if(u>=0&&u<o.length)q.push(o[u]);}var s=o.indexOf(p);if(s>-1){r(s);for(var t=1;t<h;t++){r(s+t);r(s-t);}}return q.filter(function(u){return u;});}function m(o,p){var q=p.getActiveID();if(q){var r=o.getShowingUsers(),s=l(r,q);i.get(s,function(){});}}function n(o){var p=o.getHoverController();p.registerDefault(k);p.subscribe('hover',c('debounce')(m.bind(null,o,p),100));}f.exports=n;},null);
__d('Poller',['ArbiterMixin','AsyncRequest','CurrentUser','emptyFunction','mixin','setTimeoutAcrossTransitions','setTimeout'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(l){'use strict';i.constructor.call(this);this._config=babelHelpers['extends']({clearOnQuicklingEvents:true,setupRequest:c('emptyFunction'),interval:null,maxRequests:Infinity,dontStart:false},l);this._handle=null;this._isSkipIndefinitely=false;this._requests=0;this._muted=false;this._polling=false;this._skip=false;this._cancelRequest=c('emptyFunction');if(!this._config.dontStart)this.start();}j.prototype.start=function(){'use strict';if(this._polling)return this;this._requests=0;this.request();return this;};j.prototype.stop=function(){'use strict';this._cancelRequest();return this;};j.prototype.mute=function(){'use strict';this._muted=true;return this;};j.prototype.resume=function(){'use strict';if(this._muted){this._muted=false;if(this._handle===null&&this._polling)return this.request();}if(this._isSkipIndefinitely){this._isSkipIndefinitely=false;return this.request();}return this;};j.prototype.skip=function(){'use strict';this._skip=true;return this;};j.prototype.startSkipIndefinitely=function(){'use strict';this._isSkipIndefinitely=true;return this;};j.prototype.stopSkipIndefinitely=function(){'use strict';this._isSkipIndefinitely=false;return this;};j.prototype.isSkipIndefinitely=function(){'use strict';return this._isSkipIndefinitely;};j.prototype.reset=function(){'use strict';return this.stop().start();};j.prototype.request=function(){'use strict';this._cancelRequest();this._polling=true;if(!this._config.allowNotLoggedIn&&!k())return this._done();if(this._muted)return this;var l=false;this._cancelRequest=function(){l=true;this._cleanup();}.bind(this);if(this._isSkipIndefinitely){this._deferRequest();return this;}if(++this._requests>this._config.maxRequests)return this._done();var m=new (c('AsyncRequest'))();m.setIsBackgroundRequest(true);m.setInitialHandler(function(){return !l;});m.setFinallyHandler(this._deferRequest.bind(this));m.setInitialHandler=c('emptyFunction');m.setFinallyHandler=c('emptyFunction');this._config.setupRequest(m,this);if(this._skip){this._skip=false;c('setTimeoutAcrossTransitions')(this._deferRequest.bind(this),0);}else m.send();return this;};j.prototype.isPolling=function(){'use strict';return this._polling;};j.prototype.isMuted=function(){'use strict';return this._muted;};j.prototype.setInterval=function(l){'use strict';if(l){this._config.interval=l;this.start();}};j.prototype.getInterval=function(){'use strict';return this._config.interval;};j.prototype._cleanup=function(){'use strict';if(this._handle!==null)clearTimeout(this._handle);this._handle=null;this._cancelRequest=c('emptyFunction');this._polling=false;};j.prototype._done=function(){'use strict';this._cleanup();this.inform('done',{sender:this});return this;};j.prototype._deferRequest=function(){'use strict';if(!this._polling)return;if(this._requests<this._config.maxRequests){var l=this._config.interval;l=typeof l==='function'?l(this._requests):l;l=l>j.MIN_INTERVAL?l:j.MIN_INTERVAL;if(this._config.clearOnQuicklingEvents){this._handle=c('setTimeout')(this.request.bind(this),l);}else this._handle=c('setTimeoutAcrossTransitions')(this.request.bind(this),l);}else this._done();};j.MIN_INTERVAL=2000;function k(){return c('CurrentUser').isLoggedInNow();}f.exports=j;},null);
__d('ChatImpressionLogger',['AsyncSignal','ChatConfig','ChatVisibility','Poller','PresencePrivacy','PresenceStatus','requireWeak','debounceAcrossTransitions'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=null;c('requireWeak')('AvailableList',function(n){return h=n;});var i=null;function j(){if(!i)return '';return Array.from(i.getSortedList()).toString();}function k(){if(!i||!h)return '';var n=[],o=Array.from(i.getSortedList());for(var p=0;p<o.length;p++)n[p]=h.get(o[p]);return n.toString();}function l(n){n.setURI('/ajax/chat/imps_logging.php').setData({list_availability:k(),sorted_list:j(),source:'periodical_imps'});}var m={init:function(n){i=n;var o=c('ChatConfig').get('chat_impression_logging_periodical',0);if(o){var p=c('ChatConfig').get('periodical_impression_logging_config.interval'),q=new (c('Poller'))({interval:p,setupRequest:l,clearOnQuicklingEvents:false,dontStart:true});c('PresencePrivacy').subscribe('privacy-user-presence-changed',c('debounceAcrossTransitions')(function(){if(c('ChatVisibility').isOnline()){q.start();}else q.stop();}));}this.init=function(){};},logImpression:function(n,o,p){var q=c('ChatConfig').get('chat_impression_logging_with_click'),r={list_availability:q?k():'',sorted_list:q?j():'',source:n,target:o,target_presence:c('PresenceStatus').get(o),viewport_width:document.body.clientWidth};new (c('AsyncSignal'))('/ajax/chat/ct.php',Object.assign(r,p)).send();}};f.exports=m;},null);
__d('ChatSidebarActionTypes',['keyMirror'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=c('keyMirror')({INIT:null,LOADED:null,SET_ENABLED:null,SHOW:null,TOGGLE:null});},null);
__d('ChatSidebarStore',['ChatDispatcher','ChatOptionsInitialData','ChatSidebarActionTypes','FluxStore','SidebarType','performanceAbsoluteNow'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('FluxStore'));i=h&&h.prototype;function j(){i.constructor.call(this,c('ChatDispatcher'));this.$ChatSidebarStore2={initialized:false,initTime:c('performanceAbsoluteNow')(),loaded:false,enabled:!!c('ChatOptionsInitialData').sidebar_mode,visible:null};this.$ChatSidebarStore1={};}j.prototype.__onDispatch=function(k){var l=k.type;this.$ChatSidebarStore1=babelHelpers['extends']({},this.$ChatSidebarStore2);switch(l){case c('ChatSidebarActionTypes').INIT:if(!this.$ChatSidebarStore1.initialized)this.$ChatSidebarStore2.initTime=c('performanceAbsoluteNow')();this.$ChatSidebarStore2.initialized=true;break;case c('ChatSidebarActionTypes').LOADED:this.$ChatSidebarStore2.loaded=true;break;case c('ChatSidebarActionTypes').SHOW:this.$ChatSidebarStore2.visible=k.sidebarType;break;case c('ChatSidebarActionTypes').SET_ENABLED:this.$ChatSidebarStore2.enabled=k.enabled;this.$ChatSidebarStore2.visible=k.sidebarType;break;case c('ChatSidebarActionTypes').TOGGLE:this.$ChatSidebarStore2.enabled=!this.$ChatSidebarStore2.enabled;this.$ChatSidebarStore2.visible=this.$ChatSidebarStore2.enabled?k.visible:c('SidebarType').BUDDYLIST;break;}for(var m in this.$ChatSidebarStore2)if(this.$ChatSidebarStore2.hasOwnProperty(m))if(this.$ChatSidebarStore2[m]!==this.$ChatSidebarStore1[m]){this.__emitChange();break;}};j.prototype.getPrevState=function(){return this.$ChatSidebarStore1;};j.prototype.getState=function(){return this.$ChatSidebarStore2;};j.prototype.isInitialized=function(){return this.$ChatSidebarStore2.initialized;};j.prototype.isLoaded=function(){return this.$ChatSidebarStore2.loaded;};j.prototype.isEnabled=function(){return this.$ChatSidebarStore2.enabled;};j.prototype.getInitTime=function(){return this.$ChatSidebarStore2.initTime;};j.prototype.getVisibleType=function(){return this.$ChatSidebarStore2.visible;};f.exports=new j();},null);
__d('OrderedFriendsList',['AvailableListConstants','MercuryIDs','PresenceStatus','SearchableEntry','ShortProfiles','WorkModeConfig','createArrayFromMixed','isValidUniqueID','InitialChatFriendsList'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=[],i=[],j={},k=[],l={},m=[];function n(p){p=String(p);return c('MercuryIDs').isValid(p)?p:c('MercuryIDs').getParticipantIDFromUserID(p);}var o={contains:function(p){return p in j;},getList:function(){if(c('WorkModeConfig').is_work_user)return c('createArrayFromMixed')(h);o.reRank();var p=c('createArrayFromMixed')(h);p=p.filter(function(q){var r=c('ShortProfiles').getNow(q);return !r||r.type=='friend'||r.is_nonfriend_messenger_contact;});return p;},getSearchableEntries:function(p,q){var r=o.getList();c('ShortProfiles').getMulti(r.slice(0,p),function(s){var t=[];for(var u in s)t.push(o.normalizeProfileEntry(s[u],u));var v=o.getGroups().map(o.normalizeThreadEntry);q(t.concat(v).filter(function(w){return !!w;}).sort(function(w,x){return w.getOrder()-x.getOrder();}));});},normalizeProfileEntry:function(p,q){var r=p.searchTokens||[],s=p.name,t=null;if(p.threadNickname){s=p.threadNickname;t=p.name;}return new (c('SearchableEntry'))({uniqueID:p.id||q,keywordString:r.join(' '),order:o.getRank(p.id||q),photo:p.thumbSrc,title:s,subtitle:t,type:p.type,uri:p.uri,auxiliaryData:{isMessengerUser:p.is_messenger_user}});},normalizeThreadEntry:function(p,q){var r=p.mercury_thread,s=p.participants_to_render.map(function(x){return babelHelpers['extends']({},x,{id:n(x.id)});});r.participants=r.participants.map(n);var t=p.text,u=null;if(!t)t=r.name;var v=s.map(function(x){return x.name;}).join(', ');if(!t){t=v;}else u=v;var w=p.uid;if(!t||!c('isValidUniqueID')(w))return null;return new (c('SearchableEntry'))({uniqueID:w,order:q,photo:r.image_src,title:t,subtitle:u,type:'thread',auxiliaryData:{participantsToRender:s,thread:r}});},getRank:function(p){return p in j?j[p]:h.length;},getActiveList:function(){if(k.length>0)return k;return o.getList();},getActiveRank:function(p){return p in l?l[p]:o.getRank(p);},reRank:function(){h=[];var p=0;m.forEach(function(q){var r=q.slice(0,-2),s=q.slice(-1);if(c('PresenceStatus').get(r)==s){h[p]=r;j[r]=p++;}});},rankActive:function(){var p=0;m.forEach(function(q){var r=q.slice(0,-2),s=q.slice(-1);if(s==c('AvailableListConstants').ACTIVE){k[p]=r;l[r]=p++;}});},getGroups:function(){return i;}};(function(){var p=c('InitialChatFriendsList');h=p.list.length?p.list:[];i=p.groups||[];if(p.shortProfiles)c('ShortProfiles').setMulti(p.shortProfiles);if(!c('WorkModeConfig').is_work_user){m=h.slice();o.rankActive();o.reRank();}else{m=h;h=[];m.forEach(function(q,r){var s=q.slice(0,-2);h[r]=s;j[s]=r;});}})();f.exports=b.OrderedFriendsList||o;},null);
__d('ChatSidebarVisibility',['ChatConfig','ChatSidebarStore','OrderedFriendsList','SidebarType','getViewportDimensions'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('ChatConfig').get('sidebar.min_friends'),i=c('ChatConfig').get('sidebar.minimum_width'),j={getViewport:function(){return c('getViewportDimensions').withoutScrollbars();},hasLowFriendCount:function(){return c('OrderedFriendsList').getActiveList().length<=h;},isViewportCapable:function(k){k=k||j.getViewport();return k.width>i;},shouldShowSidebar:function(k){return c('ChatSidebarStore').isEnabled()&&j.shouldShowSidebarIgnoreEnabled(k);},shouldShowSidebarIgnoreEnabled:function(k){return j.isViewportCapable(k)&&!j.hasLowFriendCount();},isSidebarVisible:function(){return c('ChatSidebarStore').getVisibleType()===c('SidebarType').SIDEBAR;},isBuddyListVisible:function(){return c('ChatSidebarStore').getVisibleType()===c('SidebarType').BUDDYLIST;}};f.exports=j;},null);
__d('ChatSidebarActions',['ChatDispatcher','ChatSidebarActionTypes','ChatSidebarVisibility','SidebarType'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(k){if(c('ChatSidebarVisibility').shouldShowSidebar(k))return c('SidebarType').SIDEBAR;return c('SidebarType').BUDDYLIST;}function i(){if(c('ChatSidebarVisibility').shouldShowSidebarIgnoreEnabled())return c('SidebarType').SIDEBAR;return c('SidebarType').BUDDYLIST;}var j={init:function(){c('ChatDispatcher').dispatch({type:c('ChatSidebarActionTypes').INIT});},loaded:function(){c('ChatDispatcher').dispatch({type:c('ChatSidebarActionTypes').LOADED});},disable:function(){c('ChatDispatcher').dispatch({type:c('ChatSidebarActionTypes').SET_ENABLED,enabled:false,sidebarType:c('SidebarType').BUDDYLIST});},enable:function(){c('ChatDispatcher').dispatch({type:c('ChatSidebarActionTypes').SET_ENABLED,enabled:true,sidebarType:i()});},show:function(k){c('ChatDispatcher').dispatch({type:c('ChatSidebarActionTypes').SHOW,sidebarType:h(k)});},toggle:function(){c('ChatDispatcher').dispatch({type:c('ChatSidebarActionTypes').TOGGLE,sidebarType:h()});}};f.exports=j;},null);
__d('FBRTCDispatcher',['Dispatcher_DEPRECATED'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new (c('Dispatcher_DEPRECATED'))();},null);
__d('FBRTCStore',['FBRTCDispatcher','FluxStore'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('FluxStore'));i=h&&h.prototype;function j(){i.constructor.call(this,c('FBRTCDispatcher'));}j.prototype.__emitChange=function(){this.__emitter.emit(this.__changeEvent);};f.exports=j;},null);
__d('FBRTCCallBlockingStore',['Arbiter','AsyncRequest','BanzaiLogger','ChannelConstants','FBRTCDispatcher','FBRTCStore','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=false,k=0,l=null,m='call_block_setting_changed';h=babelHelpers.inherits(n,c('FBRTCStore'));i=h&&h.prototype;n.prototype.init=function(o){this.$FBRTCCallBlockingStore1(o);c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('videocall_block_setting'),this.$FBRTCCallBlockingStore2.bind(this));};n.prototype.__onDispatch=function(o){if(o.type!==m)return;this.$FBRTCCallBlockingStore1(o.data);};n.prototype.$FBRTCCallBlockingStore1=function(o){switch(o){case 0:j=false;this.$FBRTCCallBlockingStore3();break;case -1:j=true;this.$FBRTCCallBlockingStore3();break;default:j=true;this.$FBRTCCallBlockingStore4(o);}this.__emitChange();};n.prototype.$FBRTCCallBlockingStore4=function(o){if(l===null)l=c('setTimeoutAcrossTransitions')(this.turnOnVideoCalling.bind(this),o*1000);};n.prototype.getBlockingStatus=function(){return j;};n.prototype.turnOnVideoCalling=function(){new (c('AsyncRequest'))('/ajax/chat/settings.php').setHandler(this.$FBRTCCallBlockingStore5.bind(this)).setData({call_blocked_until:0}).send();};n.prototype.turnOffVideoCalling=function(o){k=o;new (c('AsyncRequest'))('/ajax/chat/settings.php').setHandler(this.$FBRTCCallBlockingStore6.bind(this)).setData({call_blocked_until:o}).send();};n.prototype.$FBRTCCallBlockingStore3=function(){if(l){clearTimeout(l);l=null;}};n.prototype.$FBRTCCallBlockingStore5=function(){c('FBRTCDispatcher').dispatch({type:m,data:0});c('BanzaiLogger').log('VideoCallLoggerConfig',{event:m,message:'enable'});};n.prototype.$FBRTCCallBlockingStore6=function(){c('FBRTCDispatcher').dispatch({type:m,data:k});c('BanzaiLogger').log('VideoCallLoggerConfig',{event:m,message:'disable_'+k});};n.prototype.$FBRTCCallBlockingStore2=function(o,p){c('FBRTCDispatcher').dispatch({type:m,data:p.obj.value});};function n(){h.apply(this,arguments);}f.exports=new n();},null);
__d('ChatOptions',['Arbiter','ChannelConstants','ChatSidebarActions','FBRTCCallBlockingStore','JSLogger','PresenceUtil','ChatOptionsInitialData'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('JSLogger').create('chat_options'),i={};(function(){var k=c('ChatOptionsInitialData');for(var l in k){var m=k[l];if(l==='call_blocked_until'){c('FBRTCCallBlockingStore').init(m);}else i[l]=!!m;}})();var j=Object.assign(new (c('Arbiter'))(),{getSetting:function(k){return i[k];},setSetting:function(k,l,m){if(k==='sidebar_mode'){l?c('ChatSidebarActions').enable():c('ChatSidebarActions').disable();return;}if(this.getSetting(k)==l)return;if(m){m='from_'+m;h.log(m,{name:k,new_value:l,old_value:this.getSetting(k)});}i[k]=!!l;c('Arbiter').inform('chat/option-changed',{name:k,value:l});}});c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('setting'),function(k,l){var m=l.obj;if(m.window_id===c('PresenceUtil').getSessionID())return;j.setSetting(m.setting,!!m.value,'channel');});c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(k,l){l.chat_options=i;});f.exports=j;},null);
__d('ChatOrderedListHover',['csx','ArbiterMixin','CSS','ErrorUtils','Event','LayerHideOnBlur','Parent','mixin','setTimeoutAcrossTransitions','shield'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();function k(n){c('CSS').addClass(n,'fetching');}function l(n){c('CSS').removeClass(n,'fetching');}i=babelHelpers.inherits(m,c('mixin')(c('ArbiterMixin')));j=i&&i.prototype;function m(n){'use strict';j.constructor.call(this);this._orderedList=n;this._root=n.getRoot();c('Event').listen(this._root,'mouseover',this._mouseOver.bind(this));c('Event').listen(this._root,'mouseleave',this._mouseLeave.bind(this));n.subscribe('click',c('shield')(this._hide,this));}m.prototype._mouseOver=function(event){'use strict';if(this._paused)return;var n=event.getTarget(),o=c('Parent').bySelector(n,"._42fz")||c('Parent').bySelector(n,"._5a58");o&&this._setActiveItem(o);};m.prototype._mouseLeave=function(event){'use strict';this._setActiveItem(null);};m.prototype._clearTimeouts=function(){'use strict';this._showTimeout&&clearTimeout(this._showTimeout);this._showTimeout=null;this._hideTimeout&&clearTimeout(this._hideTimeout);this._hideTimeout=null;};m.prototype._hide=function(){'use strict';if(this._showingDialog){this._showingDialog.hide();this._showingDialog=null;this._showingID=null;}};m.prototype._show=function(){'use strict';var n=this.getActiveID(),o=false;if(this._defaultHandler){o=true;c('ErrorUtils').applyWithGuard(this._defaultHandler,{},[n,this]);}if(o&&this._showingID!=this.getActiveID())k(this._activeItem);};m.prototype._setActiveItem=function(n){'use strict';if(n!=this._activeItem){this._clearTimeouts();this._activeItem&&l(this._activeItem);if(n){this._activeItem=n;var o=this._showingDialog?0:600;this._showTimeout=c('setTimeoutAcrossTransitions')(function(){return this._show();}.bind(this),o);this.inform('hover');}else{this._activeItem=null;this._hideTimeout=c('setTimeoutAcrossTransitions')(function(){return this._hide();}.bind(this),10);this.inform('leave');}}};m.prototype.registerDefault=function(n){'use strict';this._defaultHandler=n;};m.prototype.getActiveID=function(){'use strict';var n=this._activeItem&&this._orderedList.getUserForNode(this._activeItem);return n||null;};m.prototype.showHovercard=function(n,o){'use strict';if(n==this.getActiveID()&&n!=this._showingID){this._clearTimeouts();l(this._activeItem);this._hide();this._showingDialog=o;this._showingID=n;var p=o.subscribe('mouseenter',this._setActiveItem.bind(this,this._activeItem)),q=o.subscribe('mouseleave',function(){p.unsubscribe();this._setActiveItem(null);}.bind(this)),r=o.subscribe('hide',function(){this.inform('hovercard_hide');p.unsubscribe();q.unsubscribe();r.unsubscribe();}.bind(this));o.enableBehavior(c('LayerHideOnBlur')).setContext(this._activeItem).setPosition('left').show();this.inform('hovercard_show');}};Object.assign(m.prototype,{_root:null,_activeItem:null,_hideTimeout:null,_showTimeout:null,_showingDialog:null,_showingID:null,_defaultHandler:null});f.exports=m;},null);
__d("ChatSidebarConstants",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={LITESTAND_CLASSIC_SIZE:32,IMAGE_SIZE:32};Object.assign(h,{getImageSize:function(i){if(i===false)return h.IMAGE_SIZE;return h.LITESTAND_CLASSIC_SIZE;},getItemHeight:function(){return h.IMAGE_SIZE+8;}});f.exports=h;},null);
__d('ChatQuietLinks',['DataStore','DOM','Event','Parent','UserAgent_DEPRECATED','getOrCreateDOMID'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={},i={silenceLinks:function(m){j(m,this.removeEmptyHrefs.bind(this));},nukeLinks:function(m){j(m,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(m){k(m,function(n){return !n||n==='#';});},removeAllHrefs:function(m){k(m);}};function j(m,n){var o=!!c('UserAgent_DEPRECATED').chrome(),p=!!c('UserAgent_DEPRECATED').chrome()||c('UserAgent_DEPRECATED').ie()>=9||c('UserAgent_DEPRECATED').firefox()>=4;if(h[c('getOrCreateDOMID')(m)])return;h[c('getOrCreateDOMID')(m)]=true;if(!p)return;if(!o){n&&n(m);return;}c('Event').listen(m,'mouseover',function q(r){var s=c('Parent').byTag(r.getTarget(),'a');if(s){var t=s.getAttribute('href');if(l(t)){c('DataStore').set(s,'stashedHref',s.getAttribute('href'));s.removeAttribute('href');}}});c('Event').listen(m,'mouseout',function q(r){var s=c('Parent').byTag(r.getTarget(),'a'),t=s&&c('DataStore').remove(s,'stashedHref');if(l(t))s.setAttribute('href',t);});c('Event').listen(m,'mousedown',function(q){if(!q.isDefaultRequested())return true;var r=c('Parent').byTag(q.getTarget(),'a'),s=r&&c('DataStore').get(r,'stashedHref');if(l(s))r.setAttribute('href',s);});}function k(m,n){var o=c('DOM').scry(m,'a');if(n)o=o.filter(function(p){return n(p.getAttribute('href'));});o.forEach(function(p){p.removeAttribute('href');if(!p.tabIndex)p.setAttribute('tabindex',0);});}function l(m){return m&&m!=='#';}f.exports=i;},null);
__d('SplitImage.react',['cx','React','Image.react','joinClasses'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').createClass({displayName:'SplitImage',render:function(){var j=this.props.size;return (c('React').createElement('div',babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_55lt"),style:babelHelpers['extends']({},this.props.style||{},{width:j,height:j})}),this.renderImages()));},renderImages:function(){if(!this.props.srcs)return null;var j=this.props.srcs,k=Array.isArray(j);if(k){j=j.filter(function(l){return l!==null;});if(!j.length)return null;}if(!k||j.length==1)return this.renderOne(k?j[0]:j);return j.length==2?this.renderTwo(j):this.renderThree(j);},renderOne:function(j){return (c('React').createElement(c('Image.react'),{src:j,width:this.props.size,height:this.props.size,alt:''}));},renderTwo:function(j){var k=this.props.size,l=Math.floor(k/2),m=-Math.floor(l/2),n="_55lu"+(this.props.border?' '+"_57xo":'');return (c('React').createElement('div',null,c('React').createElement('div',{className:"_55lu",style:{width:l}},c('React').createElement(c('Image.react'),{src:j[0],width:k,height:k,style:{marginLeft:m},alt:''})),c('React').createElement('div',{className:n,style:{width:l}},c('React').createElement(c('Image.react'),{src:j[1],width:k,height:k,style:{marginLeft:m},alt:''}))));},renderThree:function(j){var k=this.props.size,l=Math.floor(k/3*2),m=-Math.floor((k-l)/2),n=Math.floor(k/2),o=k-l,p=-Math.floor((n-o)/2),q="_55lu"+(this.props.border?' '+"_57pl":''),r="_55lu"+(this.props.border?' '+"_57pm":'');return (c('React').createElement('div',null,c('React').createElement('div',{className:q,style:{width:l}},c('React').createElement(c('Image.react'),{src:j[0],width:k,height:k,style:{marginLeft:m},alt:''})),c('React').createElement('div',{className:r,style:{width:o,height:n}},c('React').createElement(c('Image.react'),{src:j[1],width:n,height:n,style:{marginLeft:p},alt:''})),c('React').createElement('div',{className:"_55lu",style:{width:o,height:n}},c('React').createElement(c('Image.react'),{src:j[2],width:n,height:n,style:{marginLeft:p},alt:''}))));}});f.exports=i;},null);
__d('AbstractBadge.react',['cx','invariant','React','joinClasses'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes;function k(m){return parseInt(m,10)===m;}var l=c('React').createClass({displayName:'AbstractBadge',propTypes:{count:j.number.isRequired,maxcount:j.number},getDefaultProps:function(){return {maxcount:20};},render:function(){var m=this.props.count,n=this.props.maxcount;!k(m)?i(0):void 0;!k(n)?i(0):void 0;var o="_51lp"+(m>n?' '+"_51lr":'')+(m===0?' '+"hidden_elem":'');return (c('React').createElement('span',babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,o)}),m>n?n+'+':m));}});f.exports=l;},null);
__d('XUIBadge.react',['cx','React','AbstractBadge.react','joinClasses'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'XUIBadge',propTypes:{type:i.oneOf(['regular','special'])},getDefaultProps:function(){return {type:'regular'};},render:function(){var k=this.props.type,l="_5ugh"+(k==='regular'?' '+"_5ugf":'')+(k==='special'?' '+"_5ugg":'');return (c('React').createElement(c('AbstractBadge.react'),babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,l),type:null})));}});f.exports=j;},null);
__d('ChatSidebarItem.react',['cx','ix','xuiglyph','AvailableListConstants','XUIBadge.react','ChatConfig','ChatSidebarConstants','Image.react','Link.react','MercuryConfig','MercuryEmojiConfig','ReactComponentWithPureRenderMixin','React','SplitImage.react','TextWithEmoticons.react'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=c('ChatConfig').get('divebar_rounded_profile',false),m=9,n=c('React').createClass({displayName:'ChatSidebarItem',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{image:k.string,images:k.array,isPlayingGame:k.bool,birthday:k.bool,context:k.node,href:k.string,imageSize:k.number,name:k.node.isRequired,nameCanHaveEmoji:k.bool,onClick:k.func,status:k.number,statusTime:k.string,unreadCount:k.number,isMessengerOnlyContact:k.bool,profileBadge:k.string},render:function(){var w="_55ln"+(this.props.context?' '+"_55lo":'')+(l?' '+"_qhr":'');return (c('React').createElement(c('Link.react'),{className:w,href:{url:this.props.href},onClick:this.props.onClick,rel:'ignore'},c('React').createElement('div',{className:"_55lp"},c('React').createElement('div',{className:"_55lq"},c('React').createElement(c('SplitImage.react'),{size:this.props.imageSize||c('ChatSidebarConstants').IMAGE_SIZE,srcs:this.props.image||this.props.images})),c('React').createElement('div',{className:"_5bon"},this.renderProfileBadge(),this.renderPlayingGame(),this.renderBirthday(),this.renderUnreadCount(),this.renderStatus()),c('React').createElement('div',{className:"_55lr"},this.renderName()),c('React').createElement('div',{className:"_55ls"},this.props.context))));},renderName:function(){if(this.props.nameCanHaveEmoji){var w=c('React').createElement(c('TextWithEmoticons.react'),{renderEmoticons:true,renderEmoji:true,text:this.props.name});if(c('MercuryConfig').MessengerNewEmojiGK&&c('MercuryEmojiConfig').MessengerTextWithEmoticonsModule){var x=c('MercuryEmojiConfig').MessengerTextWithEmoticonsModule;w=c('React').createElement(x,{renderEmoticons:true,renderEmoji:true,text:this.props.name});}return w;}else return this.props.name;},renderUnreadCount:function(){var w=this.props.unreadCount;if(!w)return null;return (c('React').createElement(c('XUIBadge.react'),{count:w,maxcount:m,type:'regular'}));},renderStatus:function(){var w=this.getStatusSrc();if(!w&&!this.props.statusTime)return null;var x=w?c('React').createElement(c('Image.react'),{className:"_568_",src:w}):null,y=true;if(this.props.unreadCount&&this.props.unreadCount>0){x=this.props.statusTime?null:x;y=false;}return (c('React').createElement('div',{className:"_568z"},y?this.renderLastActiveTime():null,x));},renderLastActiveTime:function(){return (c('React').createElement('div',{className:"_568-"},this.props.statusTime));},renderBirthday:function(){if(!this.props.birthday)return null;return (c('React').createElement(c('Image.react'),{className:"_5dv3",src:s()}));},renderPlayingGame:function(){if(this.props.statusTime||this.props.birthday||!this.props.isPlayingGame)return null;return (c('React').createElement('div',{className:"_46b2"},c('React').createElement(c('Image.react'),{className:"_46b3",src:v()})));},renderProfileBadge:function(){if(this.props.statusTime||this.props.isPlayingGame||this.props.birthday||!this.props.profileBadge)return null;return (c('React').createElement('div',{className:"_46b2"},c('React').createElement(c('Image.react'),{className:"_g7p",src:this.props.profileBadge})));},getStatusSrc:function(){if(this.props.isMessengerOnlyContact)return u();return this.props.status===c('AvailableListConstants').ACTIVE?t():null;}}),o=void 0,p=void 0,q=void 0,r=void 0;function s(){if(!o)o=i('/images/gifts/icons/cake_icon.png');return o;}function t(){if(!q)q=i('/images/chat/sidebar/buddylist_nub/greenDot.png');return q;}function u(){if(!r)r=i('/images/chat/sidebar/buddylist_nub/phone.png');return r;}function v(){if(!p)p=j({name:'games',size:'small'});return p;}f.exports=n;},null);
__d('MercuryParticipantListRenderer',['fbt','MercuryIDs'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(){this.$MercuryParticipantListRenderer1=false;this.$MercuryParticipantListRenderer2=false;this.$MercuryParticipantListRenderer3=false;this.$MercuryParticipantListRenderer4=0;this.$MercuryParticipantListRenderer5=null;this.$MercuryParticipantListRenderer6=function(s){if(this.$MercuryParticipantListRenderer5){var t=c('MercuryIDs').getUserIDFromParticipantID(s.id);if(this.$MercuryParticipantListRenderer5[t])return this.$MercuryParticipantListRenderer5[t];}return this.$MercuryParticipantListRenderer2?s.short_name:s.name;}.bind(this);}i.prototype.renderParticipantList=function(s){var t=s.map(this.$MercuryParticipantListRenderer6);switch(t.length){case 0:return j(this.$MercuryParticipantListRenderer1);case 1:return k(t);case 2:return this.$MercuryParticipantListRenderer3?m(t):l(t);case 3:return this.$MercuryParticipantListRenderer3?o(t):n(t);default:return this.$MercuryParticipantListRenderer3?q(t,this.$MercuryParticipantListRenderer4):p(t,this.$MercuryParticipantListRenderer4);}};i.prototype.setIsNewThread=function(s){this.$MercuryParticipantListRenderer1=s;return this;};i.prototype.setNameRenderer=function(s){this.$MercuryParticipantListRenderer6=s;return this;};i.prototype.setUseShortName=function(s){this.$MercuryParticipantListRenderer2=s;return this;};i.prototype.setNickname=function(s){this.$MercuryParticipantListRenderer5=s;return this;};i.prototype.setUseAndSeparator=function(s){this.$MercuryParticipantListRenderer3=s;return this;};i.prototype.setTotalParticipantCount=function(s){this.$MercuryParticipantListRenderer4=s;return this;};function j(s){if(s){return h._("New message");}else return h._("No Participants");}function k(s){return s[0];}function l(s){return h._("{participant1}, {participant2}",[h.param('participant1',s[0]),h.param('participant2',s[1])]);}function m(s){return h._("{participant1} and {participant2}",[h.param('participant1',s[0]),h.param('participant2',s[1])]);}function n(s){return h._("{participant1}, {participant2}, {participant3}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2])]);}function o(s){return h._("{participant1}, {participant2}  and {participant3}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2])]);}function p(s,t){return h._("{participant1}, {participant2}, {participant3}, {others_link}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2]),h.param('others_link',r((t||s.length)-3))]);}function q(s,t){return h._("{participant1}, {participant2} and {others_link}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('others_link',r((t||s.length)-2))]);}function r(s){if(s>1){return h._({"*":"{others_count} others"},[h.param('others_count',s,[0])]);}else return h._("1 other");}f.exports=i;},null);
__d('ChatSidebarThread.react',['fbt','ChatSidebarItem.react','ChatOpenTab','MercuryParticipantListRenderer','WebMessengerPermalinkConstants','ReactComponentWithPureRenderMixin','React','TooltipData'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=10,k='\n',l=c('React').createClass({displayName:'ChatSidebarThread',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{image:i.string,imageSize:i.number,name:i.string,participants:i.array.isRequired,numOtherParticipants:i.number.isRequired,referrer:i.string,status:i.number,threadFBID:i.string,unreadCount:i.number},getDefaultProps:function(){return {numOtherParticipants:j};},render:function(){var o=this.props.name,p=m(this.props.threadFBID,this.props.participants,this.props.numOtherParticipants),q=o?p:undefined,r=this.props.image?[]:n(this.props.participants),s=o?o:p;return (c('React').createElement('div',c('TooltipData').propsFor(this._renderParticipantsTooltip()),c('React').createElement(c('ChatSidebarItem.react'),{context:q,href:c('WebMessengerPermalinkConstants').getURIPathForThreadID(this.props.threadFBID),imageSize:this.props.imageSize,image:this.props.image,images:r,name:s,nameCanHaveEmoji:true,onClick:this._handleClick,referrer:this.props.referrer,status:this.props.status,unreadCount:this.props.unreadCount})));},_renderParticipantsTooltip:function(){var o=[],p=this.props.participants.length,q=this.props.numOtherParticipants,r=Math.min(j,p);if(q-r===1)r--;for(var s=0;s<r;s++)o.push(this.props.participants[s].name);if(r<q)o.push(h._("and {num} more...",[h.param('num',q-r)]));return o.join(k);},_handleClick:function(o){o.preventDefault();c('ChatOpenTab').openThread(this.props.threadFBID,this.props.referrer);}});function m(o,p,q){return new (c('MercuryParticipantListRenderer'))().setIsNewThread(!o).setUseShortName(true).setTotalParticipantCount(q).renderParticipantList(p);}function n(o){return o.map(function(p){return p.image_src;}).filter(function(p){return p;});}f.exports=l;},null);
__d('ChatSidebarGroupThreadsGroup.react',['cx','ChatSidebarThread.react','ChatSidebarSections','ChatSidebarConstants','PresencePrivacy','PresenceStatus','React'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'ChatSidebarGroupThreadsGroup',propTypes:{groups:i.array.isRequired,isDisconnected:i.bool},render:function(){return (c('React').createElement('ul',null,this.props.groups.map(this._renderGroup)));},_renderGroup:function(k){var l=k.mercury_thread.participants,m=this.props.isDisconnected||c('PresencePrivacy').isUserOffline();return (c('React').createElement('li',{className:"_42fz"+(m?' '+"_570-":''),'data-id':k.uid,key:k.uid},c('React').createElement(c('ChatSidebarThread.react'),{image:k.mercury_thread.image_src,imageSize:c('ChatSidebarConstants').getImageSize(),name:k.mercury_thread.name,participants:k.participants_to_render,numOtherParticipants:l.length-1,referrer:c('ChatSidebarSections').ORDERED_LIST,status:c('PresenceStatus').getGroup(l),threadFBID:k.uid})));}});f.exports=j;},null);
__d('ChatSidebarHeader.react',['cx','ReactComponentWithPureRenderMixin','React','joinClasses'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').createClass({displayName:'ReactChatSidebarHeader',mixins:[c('ReactComponentWithPureRenderMixin')],render:function(){return (c('React').createElement('div',babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_55ob")}),c('React').createElement('div',{className:"_55oc"},this.props.children)));}});f.exports=i;},null);
__d('ChatSidebarUser.react',['ChatOpenTab','ChatSidebarItem.react','WebMessengerPermalinkConstants','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=c('React').createClass({displayName:'ChatSidebarUser',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{birthday:h.bool,image:h.string,imageSize:h.number,isPlayingGame:h.bool,name:h.string,sectionName:h.string.isRequired,slot:h.number,status:h.number,statusTime:h.string,unreadCount:h.number,userID:h.string.isRequired,isMessengerOnlyContact:h.bool,profileBadge:h.string},render:function(){var j=c('WebMessengerPermalinkConstants').getURIPathForIDOrVanity(this.props.userID);return (c('React').createElement(c('ChatSidebarItem.react'),{onClick:this._openTab,href:j,imageSize:this.props.imageSize,image:this.props.image,isPlayingGame:this.props.isPlayingGame,name:this.props.name,nameCanHaveEmoji:false,status:this.props.status,birthday:this.props.birthday,statusTime:this.props.statusTime,context:this.props.context,unreadCount:this.props.unreadCount,isMessengerOnlyContact:this.props.isMessengerOnlyContact,profileBadge:this.props.profileBadge}));},_openTab:function(j){c('ChatOpenTab').openUserTab(this.props.userID,this.props.sectionName,{global_slot:this.props.slot});j.preventDefault();}});f.exports=i;},null);
__d('ChatUnreadCountActionTypes',['keyMirror'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=c('keyMirror')({COUNT_UPDATED:null});},null);
__d('ChatUnreadCountStore',['ChatDispatcher','ChatUnreadCountActionTypes','FluxStore','ifRequired'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('FluxStore'));i=h&&h.prototype;function j(){i.constructor.call(this,c('ChatDispatcher'));}j.prototype.__onDispatch=function(k){var l=k.type;switch(l){case c('ChatUnreadCountActionTypes').COUNT_UPDATED:this.__emitChange();break;default:break;}};j.prototype.get=function(k){return c('ifRequired')('ChatUnreadCount',function(l){return l.get().getUnreadCountForUID(k);},function(){return 0;});};f.exports=new j();},null);
__d('PresenceStatusStore',['ChatDispatcher','FluxStore','PresenceStatus','PresenceStatusActionTypes'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('FluxStore'));i=h&&h.prototype;function j(){i.constructor.call(this,c('ChatDispatcher'));}j.prototype.__onDispatch=function(k){var l=k.type;switch(l){case c('PresenceStatusActionTypes').AVAILABILITY_CHANGED:this.__emitChange();break;default:break;}};j.prototype.get=function(k){return c('PresenceStatus').get(k);};j.prototype.getIsPlaying=function(k){return c('PresenceStatus').isPlayingCanvasGameUser(k);};f.exports=new j();},null);
__d('ShortProfilesActionTypes',['keyMirror'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=c('keyMirror')({PROFILE_UPDATED:null});},null);
__d('ShortProfilesStore',['ChatDispatcher','FluxStore','ShortProfiles','ShortProfilesActionTypes'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('FluxStore'));i=h&&h.prototype;function j(){i.constructor.call(this,c('ChatDispatcher'));}j.prototype.__onDispatch=function(k){var l=k.type;switch(l){case c('ShortProfilesActionTypes').PROFILE_UPDATED:this.__emitChange();break;default:break;}};j.prototype.get=function(k){var l=c('ShortProfiles').getNow(k);if(!l)c('ShortProfiles').get(k,this.$ShortProfilesStore1);return l;};j.prototype.$ShortProfilesStore1=function(k){c('ChatDispatcher').dispatch({type:c('ShortProfilesActionTypes').PROFILE_UPDATED});};f.exports=new j();},null);
__d('StoreAndPropBasedStateMixin',['invariant','StoreBasedStateMixinHelper','setImmediate'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=function(){for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];return {getInitialState:function(){return this.constructor.calculateState(this.props);},componentWillMount:function(){!this.constructor.calculateState?h(0):void 0;this._recalculateStateID=null;var m=function(){if(this.isMounted())this.setState(this.constructor.calculateState(this.props));this._recalculateStateID=null;}.bind(this);this._mixin=new (c('StoreBasedStateMixinHelper'))(k);this._mixin.subscribeCallback(function(){if(this._recalculateStateID===null)this._recalculateStateID=c('setImmediate')(m);}.bind(this));},componentWillReceiveProps:function(m){this.setState(this.constructor.calculateState(m));},componentWillUnmount:function(){this._mixin.release();this._mixin=null;}};}.bind(this);f.exports=i;},null);
__d("XProfileBadgeAsyncController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/profile_badge\/async\/badges\/",{user_ids:{type:"StringVector",defaultValue:[]}});},null);
__d('ChatSidebarUserGroup.react',['cx','AsyncRequest','AvailableListConstants','ChatSidebarSections','ChatSidebarUser.react','ChatUnreadCountStore','LastActiveTimes','PresencePrivacy','PresenceStatusStore','ProfileBadgeConfig','React','ShortProfilesStore','StoreAndPropBasedStateMixin','SubscriptionsHandler','XProfileBadgeAsyncController','createCancelableFunction'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=Object.keys(c('ChatSidebarSections')).map(function(l){return c('ChatSidebarSections')[l];}),k=c('React').createClass({displayName:'ChatSidebarUserGroup',_subscriptions:null,_updateProfileBadges:null,mixins:[c('StoreAndPropBasedStateMixin')(c('ChatUnreadCountStore'),c('PresenceStatusStore'),c('ShortProfilesStore'))],propTypes:{ids:i.arrayOf(i.string).isRequired,isDisconnected:i.bool,loadExtras:i.bool,sectionName:i.oneOf(j).isRequired},statics:{calculateState:function(l){var m={},n={},o=[],p={};l.ids.forEach(function(q){var r=c('PresenceStatusStore').get(q);if(r===c('AvailableListConstants').ACTIVE)n[q]=r;var s=c('ShortProfilesStore').get(q);s&&o.push(s);p[q]=c('ChatUnreadCountStore').get(q);if(l.loadExtras)m[q]=c('PresenceStatusStore').getIsPlaying(q);});return {playingMap:m,statusMap:n,unreadCounts:p,userData:o};}},componentWillMount:function(){this._subscriptions=new (c('SubscriptionsHandler'))();this._updateProfileBadges=c('createCancelableFunction')(function(){var l=c('XProfileBadgeAsyncController').getURIBuilder().setStringVector('user_ids',this.props.ids).getURI();new (c('AsyncRequest'))().setURI(l).setHandler(function(m){this.setState({userIDToProfileBadge:m.payload});}.bind(this)).send();}.bind(this));this._subscriptions.addSubscriptions(this._updateProfileBadges);this.componentWillReceiveProps(this.props);},shouldComponentUpdate:function(l,m){var n=this.props,o=n.ids,p=babelHelpers.objectWithoutProperties(n,['ids']);for(var q in p)if(p.hasOwnProperty(q))if(p[q]!==l[q])return true;var r=m.userData,s=this.state?this.state.userData:[];if(r.length!==s.length)return true;for(var t=0;t<s.length;t++)if(s[t].id!==r[t].id)return true;for(var u in this.state.unreadCounts)if(this.state.unreadCounts[u]!==m.unreadCounts[u])return true;var v=this.state.statusMap,w=m.statusMap;for(var x in v)if(v.hasOwnProperty(x))if(v[x]!==w[x])return true;for(var y in w)if(w.hasOwnProperty(y))if(w[y]!==v[y])return true;return false;},componentWillUnmount:function(){this._subscriptions.release();},componentWillReceiveProps:function(l){if(this.props.loadExtras&&c('ProfileBadgeConfig').show_sidebar_badge)this._updateProfileBadges&&this._updateProfileBadges();},render:function(){return (c('React').createElement('ul',this.props,this.state.userData.map(this._renderProfile)));},_renderProfile:function(l,m){if(!l.id)return null;var n=this.state.statusMap[l.id],o=n!==c('AvailableListConstants').ACTIVE?c('LastActiveTimes').getShortDisplay(l.id):undefined,p=this.props.isDisconnected||!c('PresencePrivacy').allows(l.id),q=this.state.userIDToProfileBadge?this.state.userIDToProfileBadge[l.id]:undefined;return (c('React').createElement('li',{className:"_42fz"+(p?' '+"_570-":''),'data-id':l.id,key:l.id},c('React').createElement(c('ChatSidebarUser.react'),{birthday:l.is_birthday,image:l.thumbSrc,imageSize:this.props.imageSize,isPlayingGame:!!this.state.playingMap[l.id],name:l.name,sectionName:this.props.sectionName,slot:m,status:n,statusTime:o,userID:l.id,unreadCount:this.state.unreadCounts[l.id],isMessengerOnlyContact:l.is_messenger_only,profileBadge:q})));}});f.exports=k;},null);
__d('ChatSidebarOrderedList.react',['cx','fbt','Bootloader','ChatQuietLinks','ChatReliabilityInstrumentation','ChatSidebarConstants','ChatSidebarGroupThreadsGroup.react','ChatSidebarHeader.react','ChatSidebarSections','ChatSidebarUserGroup.react','PresencePrivacy','ReactComponentWithPureRenderMixin','React','ReactDOM','Run','Scroll','SubscriptionsHandler','ifRequired'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=c('React').createClass({displayName:'ChatSidebarOrderedList',_subscriptions:null,mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{availableUsers:j.array.isRequired,groups:j.array.isRequired,isSidebar:j.bool.isRequired,scrollContainer:j.object,topUsers:j.array.isRequired},getInitialState:function(){return {isDisconnected:false,renderBelowFold:false};},componentDidMount:function(){c('ChatQuietLinks').nukeLinks(c('ReactDOM').findDOMNode(this));this._subscriptions=new (c('SubscriptionsHandler'))();c('Run').onAfterLoad(function(){this.setState({renderBelowFold:true});this._bootloadChannelSubscription();}.bind(this));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){var l=c('PresencePrivacy').getOnlinePolicy()===c('PresencePrivacy').ONLINE_TO_WHITELIST&&c('PresencePrivacy').getVisibility()?this._renderOfflineSection():this._renderOnlineSection();return (c('React').createElement('div',null,this._renderFriendsSection(),this._renderGroupsSection(),l));},_scrollToSeparator:function(l){var m=this.props.scrollContainer;if(!m)return;var n=m.clientHeight,o=m.scrollHeight,p=c('Scroll').getTop(m),q=Math.min(l.offsetTop,o-n);if(p!==q)c('ifRequired')('Animation',function(r){var s=Math.abs(q-p)/m.clientHeight*500;new r(m).to('scrollTop',q).ease(r.ease.end).duration(s).go();},function(){c('Scroll').setTop(m,q);});},_renderOfflineSection:function(){var l=c('ChatSidebarConstants').getImageSize(this.props.isSidebar),m=this.props.topUsers.filter(function(o){return !c('PresencePrivacy').allows(o);});m.splice(-2);var n=c('React').createElement('a',{ajaxify:'/ajax/chat/privacy/settings_dialog.php?ref=whitelist_separator',href:'#',rel:'dialog'},i._("Edit"));return [c('React').createElement(c('ChatSidebarHeader.react'),{key:'usersSeparator1'},i._("MORE FRIENDS")),c('React').createElement(c('ChatSidebarHeader.react'),{className:"_5j9-",key:'usersSeparator2'},i._("These friends can't see you on chat. {=link}",[i.param('=link',n)])),c('React').createElement(c('ChatSidebarUserGroup.react'),{ids:m,isDisconnected:this.state.isDisconnected,imageSize:l,key:c('ChatSidebarSections').OFFLINE_USERS,loadExtras:this.state.renderBelowFold,sectionName:c('ChatSidebarSections').OFFLINE_USERS})];},_renderOnlineSection:function(){if(this.props.availableUsers.length===0)return null;if(!this.state.renderBelowFold){var l=c('ChatSidebarConstants').getItemHeight();return [c('React').createElement('div',{key:c('ChatSidebarSections').MORE_ONLINE_FRIENDS,style:{height:l*this.props.availableUsers.length}})];}var m=c('ChatSidebarConstants').getImageSize(this.props.isSidebar),n=i._("{MORE ONLINE FRIENDS} ({=count})",[i.param('MORE ONLINE FRIENDS',i._("MORE FRIENDS")),i.param('=count',this.props.availableUsers.length)]),o=c('React').createElement(c('ChatSidebarUserGroup.react'),{ids:this.props.availableUsers,imageSize:m,isDisconnected:this.state.isDisconnected,key:c('ChatSidebarSections').MORE_ONLINE_FRIENDS,loadExtras:this.state.renderBelowFold,sectionName:c('ChatSidebarSections').MORE_ONLINE_FRIENDS});return [c('React').createElement(c('ChatSidebarHeader.react'),{ref:'usersSeparator',key:'usersSeparator',onClick:function(){return this._scrollToSeparator(c('ReactDOM').findDOMNode(this.refs.usersSeparator));}.bind(this)},n),o];},_renderGroupsSection:function(){if(this.props.groups.length===0)return null;var l=this.state.isDisconnected||c('PresencePrivacy').isUserOffline();return [c('React').createElement(c('ChatSidebarHeader.react'),{ref:'groupSeparator',key:'groupSeparator',className:l?"_570-":'',onClick:function(){return this._scrollToSeparator(c('ReactDOM').findDOMNode(this.refs.groupSeparator));}.bind(this)},i._("GROUP CONVERSATIONS")),c('React').createElement(c('ChatSidebarGroupThreadsGroup.react'),{groups:this.props.groups,isDisconnected:this.state.isDisconnected,key:'group_threads_section',loadExtras:this.state.renderBelowFold})];},_renderFriendsSection:function(){var l=c('ChatSidebarConstants').getImageSize(this.props.isSidebar),m=this.props.topUsers;if(c('PresencePrivacy').getVisibility()==c('PresencePrivacy').ONLINE)m=this.props.topUsers.filter(function(n){return c('PresencePrivacy').allows(n);});return (c('React').createElement(c('ChatSidebarUserGroup.react'),{key:c('ChatSidebarSections').ORDERED_LIST,ids:m,isDisconnected:this.state.isDisconnected,imageSize:l,loadExtras:this.state.renderBelowFold,sectionName:c('ChatSidebarSections').ORDERED_LIST}));},_bootloadChannelSubscription:function(){c('Bootloader').loadModules(["ChannelConnection"],function(l){this._subscriptions.addSubscriptions(l.subscribe([l.CONNECTED,l.RECONNECTING,l.SHUTDOWN,l.MUTE_WARNING,l.UNMUTE_WARNING],function(){var m=l.disconnected();if(m!==this.state.isDisconnected){if(m){c('ChatReliabilityInstrumentation').logCHANNEL_DISCONNECT();}else c('ChatReliabilityInstrumentation').logCHANNEL_CONNECT();this.setState({isDisconnected:m});}}.bind(this)));}.bind(this),'ChatSidebarOrderedList.react');}});f.exports=k;},null);
__d('ChatSortUsers',['ShortProfiles','TokenizeUtil'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={};function i(k){if(h[k])return h[k];var l=(c('ShortProfiles').getNow(k)||{}).name;if(l)return h[k]=c('TokenizeUtil').flatten(l);return '~';}var j={sortAlphabetical:function(k,l){var m=i(k),n=i(l);if(m!==n)return m<n?-1:1;return 0;}};f.exports=j;},null);
__d('PresenceOrderedList',['ChatSortUsers','InitialChatFriendsList','PresencePrivacy','PresenceStatus'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(){'use strict';this.$PresenceOrderedList1=this.$PresenceOrderedList2();}h.prototype.getSorted=function(i){'use strict';var j=[];this.$PresenceOrderedList1.forEach(function(k){var l=k[0],m=k[1];if(j.length>=i)return false;if(c('PresencePrivacy').getFriendVisibility(l)==c('PresencePrivacy').BLACKLISTED)return true;if(m==c('PresenceStatus').get(l))j.push(l);});return j;};h.prototype.getAvailableSorted=function(i){'use strict';var j=c('PresenceStatus').getOnlineIDs();if(i)j=j.filter(function(k){return i&&i.indexOf(k)===-1;});return j.sort(c('ChatSortUsers').sortAlphabetical);};h.prototype.$PresenceOrderedList2=function(){'use strict';var i=c('InitialChatFriendsList').list||[];return i.map(function(j){var k=j.slice(0,-2),l=Number(j.slice(-1));return [k,l];});};f.exports=new h();},null);
__d('ChatOrderedList',['csx','Arbiter','ArbiterMixin','AvailableList','AvailableListConstants','CSS','ChatConfig','ChatHovercard','ChatOptions','ChatOrderedListHover','ChatSidebarConstants','ChatSidebarOrderedList.react','DOM','DataStore','Event','InitialChatFriendsList','JSLogger','Parent','PresenceOrderedList','PresencePrivacy','React','ReactDOM','debounceAcrossTransitions','mixin','shield'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('mixin')(c('ArbiterMixin')));j=i&&i.prototype;function k(l,m){'use strict';j.constructor.call(this);this._isSidebar=l;this._root=m;this._isVisible=false;this._excludedIds={};this._numTopFriends=5;this._groups=[];this._hoverController=null;this._isHovering=false;this._topUsers=[];this._orderedList=c('DOM').find(this._root,'.fbChatOrderedList');c('Event').listen(this._orderedList,'mouseover',function(){this._isHovering=true;}.bind(this));c('Event').listen(this._orderedList,'mouseout',function(){this._isHovering=false;this._render();}.bind(this));this._scrollableOrderedList=c('Parent').byClass(this._root,'scrollableOrderedList');this._scrollableArea=c('Parent').byClass(this._root,'scrollable');if(this._isSidebar)new (c('ChatHovercard'))(this);c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(n,o){o.chat_lists=o.chat_lists||{sorted_list:this.getOrderedList(),available_list:c('PresenceOrderedList').getAvailableSorted(),excluded_list:this._excludedIds};}.bind(this));c('PresencePrivacy').subscribe('privacy-user-presence-changed',c('shield')(this.updateTopUsers,this));c('AvailableList').subscribe(c('AvailableListConstants').ON_AVAILABILITY_CHANGED,c('shield')(this.updateTopUsers,this));}k.prototype.getShowingUsers=function(){'use strict';return c('DOM').scry(this._root,"li._42fz,li._5a58").map(this.getUserForNode);};k.prototype.getUserForNode=function(l){'use strict';return c('DataStore').get(l,'id')||c('DataStore').get(l,'serverthreadid');};k.prototype.getHoverController=function(){'use strict';if(!this._hoverController)this._hoverController=new (c('ChatOrderedListHover'))(this);return this._hoverController;};k.prototype.getItemHeight=function(){'use strict';return c('ChatSidebarConstants').getItemHeight();};k.prototype.getRoot=function(){'use strict';return this._root;};k.prototype.getSortedList=function(){'use strict';return this._topUsers=c('PresenceOrderedList').getSorted(this._numTopFriends);};k.prototype.updateTopUsers=function(){'use strict';this.getSortedList();this._render();};k.prototype.hide=function(){'use strict';if(!this._isVisible)return;this._isVisible=false;c('CSS').hide(this._scrollableOrderedList||this._root);this.inform('hide');};k.prototype.setNumTopFriends=function(l,m){'use strict';if(c('ChatConfig').get('web_messenger_divebar_show_more_groups')){this.setNumTopFriendsMoreGroups(l,m);return;}var n=this._getGroups(),o=l-n.length;if(o>c('ChatConfig').get('min_top_friends'))l=o;l--;if(l!==this._numTopFriends||n.length!==this._groups.length){this._groups=n;this._numTopFriends=l;this.getSortedList();if(m){this._renderOrderedList();}else this._render();}};k.prototype.setNumTopFriendsMoreGroups=function(l,m){'use strict';var n=this._getGroups(),o=Math.max(Math.min(Math.floor(l/5),n.length),2),p=n.length>o?o:n.length,q=Math.max(l-p,1);if(q>1)q--;n=n.slice(0,p);if(q!==this._numTopFriends||n.length!==this._groups.length){this._numTopFriends=q;this._groups=n;if(m){this._renderOrderedList();}else this._render();}};k.prototype._renderOrderedList=function(){'use strict';if(!this._isVisible||this._isHovering)return;var l=c('PresenceOrderedList').getAvailableSorted(this._topUsers);c('ReactDOM').render(c('React').createElement(c('ChatSidebarOrderedList.react'),{availableUsers:l,isSidebar:this._isSidebar,scrollContainer:this._scrollContainer,topUsers:this._topUsers,groups:this._groups}),this._orderedList);this.inform('render');};k.prototype._render=function(){'use strict';this._render=c('debounceAcrossTransitions')(this._renderOrderedList.bind(this),300);this._render();};k.prototype.show=function(){'use strict';if(this._isVisible)return;this._isVisible=true;c('CSS').show(this._scrollableOrderedList||this._root);this._render();this.inform('show');};k.prototype.isVisible=function(){'use strict';return this._isVisible;};k.prototype.setScrollContainer=function(l){'use strict';if(c('DOM').contains(l,this._root))this._scrollContainer=l;};k.prototype._getGroups=function(){'use strict';if(!c('ChatOptions').getSetting('hide_groups')){return c('InitialChatFriendsList').groups||[];}else return [];};f.exports=k;},null);
__d('ChatPerfTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(){this.clear();}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:ChatPerfLoggerConfig',this.$ChatPerfTypedLogger1,c('Banzai').BASIC);};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:ChatPerfLoggerConfig',this.$ChatPerfTypedLogger1,c('Banzai').VITAL);};h.prototype.clear=function(){this.$ChatPerfTypedLogger1={};return this;};h.prototype.updateData=function(j){this.$ChatPerfTypedLogger1=babelHelpers['extends']({},this.$ChatPerfTypedLogger1,j);return this;};h.prototype.setDuration=function(j){this.$ChatPerfTypedLogger1.duration=j;return this;};h.prototype.setEndpoint=function(j){this.$ChatPerfTypedLogger1.endpoint=j;return this;};h.prototype.setEvent=function(j){this.$ChatPerfTypedLogger1.event=j;return this;};h.prototype.setTabsOpen=function(j){this.$ChatPerfTypedLogger1.tabs_open=j;return this;};var i={duration:true,endpoint:true,event:true,tabs_open:true};f.exports=h;},null);
__d('Dcode',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h,i={},j={_:'%',A:'%2',B:'000',C:'%7d',D:'%7b%22',E:'%2c%22',F:'%22%3a',G:'%2c%22ut%22%3a1',H:'%2c%22bls%22%3a',I:'%2c%22n%22%3a%22%',J:'%22%3a%7b%22i%22%3a0%7d',K:'%2c%22pt%22%3a0%2c%22vis%22%3a',L:'%2c%22ch%22%3a%7b%22h%22%3a%22',M:'%7b%22v%22%3a2%2c%22time%22%3a1',N:'.channel%22%2c%22sub%22%3a%5b',O:'%2c%22sb%22%3a1%2c%22t%22%3a%5b',P:'%2c%22ud%22%3a100%2c%22lc%22%3a0',Q:'%5d%2c%22f%22%3anull%2c%22uct%22%3a',R:'.channel%22%2c%22sub%22%3a%5b1%5d',S:'%22%2c%22m%22%3a0%7d%2c%7b%22i%22%3a',T:'%2c%22blc%22%3a1%2c%22snd%22%3a1%2c%22ct%22%3a',U:'%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',V:'%2c%22blc%22%3a0%2c%22snd%22%3a0%2c%22ct%22%3a',W:'%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a',X:'%2c%22ri%22%3a0%7d%2c%22state%22%3a%7b%22p%22%3a0%2c%22ut%22%3a1',Y:'%2c%22pt%22%3a0%2c%22vis%22%3a1%2c%22bls%22%3a0%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',Z:'%2c%22sb%22%3a1%2c%22t%22%3a%5b%5d%2c%22f%22%3anull%2c%22uct%22%3a0%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a'};(function(){var l=[];for(var m in j){i[j[m]]=m;l.push(j[m]);}l.reverse();h=new RegExp(l.join("|"),'g');})();var k={encode:function(l){return encodeURIComponent(l).replace(/([_A-Z])|%../g,function(m,n){return n?'%'+n.charCodeAt(0).toString(16):m;}).toLowerCase().replace(h,function(m){return i[m];});},decode:function(l){return decodeURIComponent(l.replace(/[_A-Z]/g,function(m){return j[m];}));}};f.exports=k;},null);
__d('PresenceCookieManager',['Cookie','CurrentUser','Dcode','ErrorUtils','JSLogger','PresenceInitialData','PresenceUtil','URI'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('PresenceInitialData').cookieVersion,i='presence',j={},k=null,l=null,m=c('JSLogger').create('presence_cookie');function n(){try{var r=c('Cookie').get(i);if(k!==r){k=r;l=null;if(r&&r.charAt(0)=='E')r=c('Dcode').decode(r.substring(1));if(r)l=JSON.parse(r);}if(l){if(l.user&&l.user!==c('CurrentUser').getID())return null;if(l.v!==h)return null;return l;}}catch(q){m.warn('getcookie_error',q);}return null;}function o(){return parseInt(Date.now()/1000,10);}var p={register:function(q,r){j[q]=r;},store:function(){var q=n();if(q&&q.v&&h<q.v){m.debug('stale_cookie',h);return;}var r={v:h,time:o(),user:c('CurrentUser').getID()};for(var s in j)r[s]=c('ErrorUtils').applyWithGuard(j[s],j,[q&&q[s]],function(w){w.presence_subcookie=s;});var t='E'+c('Dcode').encode(JSON.stringify(r));if(c('PresenceUtil').hasUserCookie()){var u=t.length;if(u>1024)m.warn('big_cookie',u);var v=c('URI').getRequestURI(false).isSecure()&&!!c('Cookie').get('csm');c('Cookie').set(i,t,null,null,v);}},clear:function(){c('Cookie').clear(i);},getSubCookie:function(q){var r=n();if(!r)return null;return r[q];}};f.exports=p;},null);
__d('PresenceState',['Arbiter','ErrorUtils','JSLogger','PresenceCookieManager','debounceAcrossTransitions','setIntervalAcrossTransitions','PresenceInitialData'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('PresenceInitialData').cookiePollInterval||2000,i=c('PresenceInitialData').shouldSuppress||false,j=[],k=[],l=null,m=null,n=0,o=null,p=0,q=['sb2','t2','lm2','uct2','tr','tw','at','wml'],r=c('JSLogger').create('presence_state');function s(){return c('PresenceCookieManager').getSubCookie('state');}function t(){n=Date.now();c('PresenceCookieManager').store();x(m);}var u=c('debounceAcrossTransitions')(t,0);function v(ca){if(typeof ca=='undefined'||isNaN(ca)||ca==Number.POSITIVE_INFINITY||ca==Number.NEGATIVE_INFINITY)ca=0;return ca;}function w(ca){var da={};if(ca){q.forEach(function(ga){da[ga]=ca[ga];});if(n<ca.ut)r.error('new_cookie',{cookie_time:ca.ut,local_time:n});}da.ut=n;for(var ea=0,fa=j.length;ea<fa;ea++)c('ErrorUtils').applyWithGuard(j[ea],null,[da]);m=da;return m;}function x(ca){p++;n=v(ca.ut);if(!l)l=c('setIntervalAcrossTransitions')(aa,h);m=ca;if(o===null)o=ca;for(var da=0,ea=k.length;da<ea;da++)c('ErrorUtils').applyWithGuard(k[da],null,[ca]);p--;}function y(ca){if(ca&&ca.ut)if(n<ca.ut){return true;}else if(ca.ut<n)r.error('old_cookie',{cookie_time:ca.ut,local_time:n});return false;}function z(){var ca=s();if(y(ca))m=ca;return m;}function aa(){var ca=s();if(y(ca))x(ca);}c('PresenceCookieManager').register('state',w);c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(ca,da){da.presence_state={initial:babelHelpers['extends']({},o),state:babelHelpers['extends']({},m),update_time:n,sync_paused:p,poll_time:h};});(function(){var ca=z();if(ca){x(ca);}else{r.debug('no_cookie_initial');x(w());return;}})();var ba={doSync:function(ca){if(p)return;if(ca){t();}else u();},registerStateStorer:function(ca){j.push(ca);},registerStateLoader:function(ca){k.push(ca);},get:function(){return z();},getInitial:function(){return o;},shouldSuppress:function(){return i;},verifyNumber:v};f.exports=ba;},null);
__d('ChatPerfInstrumentation',['Promise','BaseEventEmitter','ChatPerfEvent','ChatPerfTypedLogger','PresenceState','emptyFunction','performanceAbsoluteNow'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=void 0,i=c('PresenceState').getInitial()&&c('PresenceState').getInitial().t2?c('PresenceState').getInitial().t2.length:null,j={_startTime:(Number),_sidebarStartTime:(Number),init:function(){this._startTime=c('performanceAbsoluteNow')();return new (c('Promise'))(function(k){return k();});},initDivebar:function(){this._sidebarStartTime=c('performanceAbsoluteNow')();},_log:function(event,k){var l=c('performanceAbsoluteNow')()-(k||this._startTime);if(h)h.emit(event,l);var m=new (c('ChatPerfTypedLogger'))();m.setEvent(event).setDuration(l);if(i!==null)m.setTabsOpen(i);m.log();},addPerfTimingsListener:function(event,k){if(!h)h=new (c('BaseEventEmitter'))();return h.once(event,k);},logInitStores:function(){this.logInitStores=c('emptyFunction');this._log(c('ChatPerfEvent').CHAT_INIT_STORES);},logInitData:function(){this.logInitData=c('emptyFunction');this._log(c('ChatPerfEvent').CHAT_INIT_DATA);},logInitUI:function(){this.logInitUI=c('emptyFunction');this._log(c('ChatPerfEvent').CHAT_INIT_UI);},logInitSound:function(){this.logInitSound=c('emptyFunction');this._log(c('ChatPerfEvent').CHAT_INIT_SOUND);},logDisplayDone:function(){this.logDisplayDone=c('emptyFunction');this._log(c('ChatPerfEvent').CHAT_DISPLAY_DONE);},logTTI:function(){this.logTTI=c('emptyFunction');this._log(c('ChatPerfEvent').TTI);},logCHAT_CONVERSATION_TTI:function(){this.logCHAT_CONVERSATION_TTI=c('emptyFunction');this._log(c('ChatPerfEvent').CHAT_CONVERSATION_TTI);},logSIDEBAR_FROM_CLIENT_TTI:function(){this.logSIDEBAR_FROM_CLIENT_TTI=c('emptyFunction');this._log(c('ChatPerfEvent').SIDEBAR_FROM_CLIENT_TTI,this._sidebarStartTime);},logSIDEBAR_DISPLAY_DONE:function(){this.logSIDEBAR_DISPLAY_DONE=c('emptyFunction');this._log(c('ChatPerfEvent').SIDEBAR_DISPLAY_DONE,this._sidebarStartTime);}};f.exports=j;},null);
__d('MercuryTypeaheadDataSource',['CurrentUser','DataSource','MercuryConfig','MercuryParticipantTypes','MercuryTypeaheadConstants','OrderedFriendsList','ShortProfiles','WorkModeConfig','debounce'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();var j=500,k=[],l={},m={},n={},o=false,p=false;h=babelHelpers.inherits(q,c('DataSource'));i=h&&h.prototype;function q(r){'use strict';r=r||{};r.kanaNormalization=true;i.constructor.call(this,r);}q.prototype.dirty=function(){'use strict';this.$MercuryTypeaheadDataSource1=k;this.localCache=m;this.queryCache=l;this.queryIDs=n;return this;};q.prototype.bootstrap=function(){'use strict';if(o||p)return false;p=true;c('ShortProfiles').fetchAll().then(function(){this.updateBootstrapData();p=false;o=true;}.bind(this),function(){}.bind(this));return true;};q.prototype.updateBootstrapData=function(){'use strict';var r=this.getCachedShortProfileIDs(),s=c('WorkModeConfig').is_work_user?c('MercuryParticipantTypes').FB4C:c('MercuryParticipantTypes').FRIEND,t=r.map(function(u){var v=c('ShortProfiles').getNow(u),w=u==c('CurrentUser').getID()?s:v.type,x=[v.additionalName,v.alternateName].concat(v.searchTokens||[]).join(' '),y=v.name,z=null;if(v.threadNickname){y=v.threadNickname;z=v.name;}return {uid:u,index:c('OrderedFriendsList').getActiveRank(u),text:y,subtext:z,tokens:x,localized_text:v.name,additional_text:v.additionalName,photo:v.thumbSrc,render_type:w,type:c('MercuryTypeaheadConstants').USER_TYPE};});if(t.length)this.addEntries(t);};q.prototype.query=function(r,s,t,u){'use strict';var v=s||r.length===1;return i.query.call(this,r,v,t,u);};q.prototype.getQueryData=function(r,s){'use strict';return babelHelpers['extends']({},i.getQueryData.call(this,r,s));};q.prototype.setEntry=function(r,s){'use strict';this.$MercuryTypeaheadDataSource1[r]=s;};q.prototype.getEntry=function(r){'use strict';return this.$MercuryTypeaheadDataSource1[r]||null;};q.prototype.getCachedShortProfileIDs=function(){'use strict';var r=c('ShortProfiles').getCachedProfileIDs(),s=r.filter(function(t){var u=c('ShortProfiles').getNow(t);return (t==c('CurrentUser').getID()||u.type===c('MercuryParticipantTypes').FRIEND||u.type===c('MercuryParticipantTypes').FB4C||u.type===c('MercuryParticipantTypes').PAGE&&c('MercuryConfig').LinkedAgents&&c('MercuryConfig').LinkedAgents.indexOf(t.toString())>-1);});return s;};q.prototype.isBootstrapped=function(){'use strict';return o;};q.prototype.isBootstrapping=function(){'use strict';return p;};q.prototype.processEntries=function(r,s){'use strict';r=r.map(function(t){if(t.index==null&&(t.render_type===c('MercuryParticipantTypes').FRIEND||t.render_type===c('MercuryParticipantTypes').FB4C))t.index=c('OrderedFriendsList').getActiveRank(t.uid);if(t.render_type===c('MercuryParticipantTypes').PAGE&&c('MercuryConfig').LinkedAgents&&c('MercuryConfig').LinkedAgents.indexOf(t.uid.toString())>-1)t.index=1;return t;});return i.processEntries.call(this,r);};q.prototype.mergeUids=function(r,s,t,u){'use strict';var v=s.sort(function(w,x){return this.getEntry(w).index-this.getEntry(x).index;}.bind(this));return i.mergeUids.call(this,r,v,t,u);};f.exports=q;},null);
__d('ChatTabTypeaheadDataSource',['MercuryConfig','MercuryTypeaheadConstants','MercuryTypeaheadDataSource'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('MercuryTypeaheadDataSource'));i=h&&h.prototype;function j(k){'use strict';k=k||{};k.maxResults=c('MercuryTypeaheadConstants').COMPOSER_CHATTAB_MAX;i.constructor.call(this,k);this.$ChatTabTypeaheadDataSource1=true;}j.prototype.buildData=function(k){'use strict';var l=[],m=[],n=[],o=[],p=[],q=[];k.forEach(function(s){var t=i.getEntry.call(this,s);switch(t.render_type){case c('MercuryTypeaheadConstants').FRIEND_TYPE:l.push(s);break;case c('MercuryTypeaheadConstants').THREAD_TYPE:if(this.$ChatTabTypeaheadDataSource1)m.push(s);break;case c('MercuryTypeaheadConstants').NON_FRIEND_TYPE:n.push(s);break;case c('MercuryTypeaheadConstants').FB4C_TYPE:o.push(s);break;case c('MercuryTypeaheadConstants').PAGE_TYPE:if(this.$ChatTabTypeaheadDataSource1)if(c('MercuryConfig').LinkedAgents&&c('MercuryConfig').LinkedAgents.indexOf(s.toString())>-1){q.push(s);}else p.push(s);break;default:break;}},this);var r=q.concat(l,o,m,p,n);return i.buildData.call(this,r);};j.prototype.query=function(k,l,m,n){'use strict';return i.query.call(this,k,l,m,n);};j.prototype.respond=function(k,l,m){'use strict';return i.respond.call(this,k,l,m);};j.prototype.setShowThreads=function(k){'use strict';this.$ChatTabTypeaheadDataSource1=k;};f.exports=j;},null);
__d('ChatSidebar',['csx','Arbiter','AsyncRequest','Bootloader','ChatDispatcher','ChatImpressionLogger','ChatPerfInstrumentation','ChatSidebarActions','ChatSidebarStore','ChatSidebarVisibility','CSS','DOM','DOMDimensions','Event','LogHistory','JSLogger','KeyEventController','LitestandClassicPlaceHolders','Parent','PresencePrivacy','PresenceUtil','ScrollableArea','SidebarType','Style','TimeSlice','ViewportBounds','debounce','emptyFunction','ge'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i,j,k,l,m,n,o=false,p,q=true,r=null,s=c('LogHistory').getInstance('chat_sidebar');function t(){return c('ChatSidebarStore').getVisibleType()===c('SidebarType').SIDEBAR;}function u(ea,fa){if(!t())return;if(fa){m.hide();}else{m.show();x();}}function v(){return !t()||!l?0:206;}function w(){c('CSS').removeClass(document.documentElement,'sidebarMode');if(!c('ChatSidebarStore').isInitialized()){c('Arbiter').inform('reflow');c('ViewportBounds').inform('change');return;}m.hide();c('CSS').hide(l);c('CSS').hide(k);c('Arbiter').inform('sidebar/visibility',false,c('Arbiter').BEHAVIOR_STATE);c('Arbiter').inform('reflow');c('ViewportBounds').inform('change');}function x(ea){if(!ea||ea.width!==r.width)c('ChatSidebarActions').show(r);if(!ea||ea.height!==r.height)aa();}function y(ea){var fa=r||c('ChatSidebarVisibility').getViewport(),ga=fa.height;ea.forEach(function(ha){if(ha&&ha!==i&&!c('CSS').hasClass(ha,'hidden_elem'))ga-=c('DOMDimensions').getElementDimensions(ha).height;});if(p)ga-=p.getOffset();if(n)ga-=c('DOMDimensions').getElementDimensions(n).height;return Math.max(0,ga);}function z(){c('CSS').show(k);c('CSS').show(l);c('CSS').addClass(document.documentElement,'sidebarMode');m.show();s.log('sidebar_show','{}');c('Arbiter').inform('sidebar/visibility',true,c('Arbiter').BEHAVIOR_STATE);c('LitestandClassicPlaceHolders').destroy('sidebar');c('ViewportBounds').inform('change');if(!o){aa();o=true;}}function aa(){if(!t())return;var ea=da.getBodyHeight(),fa=m.getItemHeight(),ga=8;c('Style').set(i,'height',ea+'px');var ha=Math.floor((ea-ga)/fa);m.setNumTopFriends(ha,q);q=false;var ia=Math.floor(ea-ga);c('Arbiter').inform('sidebar/resized',ia,c('Arbiter').BEHAVIOR_STATE);c('Arbiter').inform('reflow');}function ba(){new (c('AsyncRequest'))('/ajax/chat/settings.php').setHandler(c('emptyFunction')).setErrorHandler(c('emptyFunction')).setData({sidebar_mode:c('ChatSidebarStore').isEnabled(),window_id:c('PresenceUtil').getSessionID()}).setAllowCrossPageTransition(true).send();}function ca(){var ea=true;if(!c('ChatSidebarStore').isEnabled()){s.log('state_not_enabled','{}');ea=false;}if(c('ChatSidebarVisibility').hasLowFriendCount()){s.log('state_not_shown_num_friends','{}');ea=false;}if(!c('ChatSidebarVisibility').isViewportCapable(r))ea=false;var fa=ea?'state_shown':'state_not_shown';s.log(fa,'{}');c('ChatPerfInstrumentation').logSIDEBAR_FROM_CLIENT_TTI();}var da={init:function(ea,fa){da.init=c('emptyFunction');c('ChatPerfInstrumentation').initDivebar();c('ChatDispatcher').explicitlyRegisterStore(c('ChatSidebarStore'));c('ChatSidebarActions').loaded();l=ea;m=fa;i=c('DOM').find(ea,'div.fbChatSidebarBody');k=c('DOM').find(ea,"._51x_");n=c('DOM').find(ea,"._5qqe");c('Event').listen(window,'resize',function(){var ga=babelHelpers['extends']({},r)||{};this._cacheViewport();x(ga);}.bind(this));c('KeyEventController').registerKey('q',function(event){if(c('ChatSidebarStore').getVisibleType()!==c('SidebarType').SIDEBAR)return;if(!j){var ga=c('DOM').scry(ea,"._3rhb input");if(ga.length>0)j=ga[0];}if(j){j.focus();event.prevent();}});m.setScrollContainer(c('Parent').byClass(m.getRoot(),'uiScrollableAreaWrap'));m.subscribe(['render','show','hide'],c('debounce')(function(ga){var ha=c('ScrollableArea').getInstance(m.getRoot());ha&&ha.adjustGripper();}));c('Arbiter').subscribe('chat/option-changed',function(ga,ha){if(ha.name==='hide_groups')aa();});c('Arbiter').subscribe(['AppsDivebar/show-apps','AppsDivebar/hide-apps','Ticker/resized'],aa);c('Arbiter').subscribe('sidebar/typeahead/active',u);c('PresencePrivacy').subscribe('privacy-user-presence-changed',x);c('ChatSidebarStore').addListener(function(){var ga=c('ChatSidebarStore').getState(),ha=c('ChatSidebarStore').getPrevState();if(ga.visible!==ha.visible)switch(ga.visible){case c('SidebarType').SIDEBAR:z();break;case c('SidebarType').BUDDYLIST:w();break;}if(ga.enabled!==ha.enabled)ba();});this._cacheViewport();x();c('ChatImpressionLogger').init(m);c('ViewportBounds').addPersistentRight(v);c('Arbiter').inform('sidebar/initialized',da,c('Arbiter').BEHAVIOR_STATE);c('ChatSidebarActions').init();ca();c('ChatPerfInstrumentation').logSIDEBAR_DISPLAY_DONE();},ensureLoaded:function(){if(!c('ChatSidebarStore').isEnabled())return;if(c('ChatSidebarStore').isLoaded())return;if(c('ge')('pagelet_sidebar'))return;c('Bootloader').loadModules(["UIPagelet"],function(ea){var fa=c('DOM').create('div',{id:'pagelet_sidebar'});c('DOM').appendContent(document.body,fa);ea.loadFromEndpoint('SidebarPagelet','pagelet_sidebar');},'ChatSidebar');c('ChatSidebarActions').loaded();},hide:function(){if(!c('ChatSidebarStore').isEnabled())return;c('ChatSidebarActions').disable();},unhide:function(){if(c('ChatSidebarStore').isEnabled())return;c('ChatSidebarActions').enable();},_cacheViewport:function(){r=c('ChatSidebarVisibility').getViewport();},getBodyHeight:function(){return y(Array.from(k.childNodes));}};c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(ea,fa){fa.sidebar_visible=t();});da.init=c('TimeSlice').guard(da.init,'ChatSidebar init');f.exports=da;},null);