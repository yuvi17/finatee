if (self.CavalryLogger) { CavalryLogger.start_js(["0PDmw"]); }

__d("MercuryCommands",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ME:"\/me "};},null);
__d("MessagesViewerSetID",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={MESSAGES:"messages",MESSAGES_VIEW_ALL_IN_THREAD:"messages:view_all_in_thread"};},null);
__d("MNCommerceMessageType",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={TEXT:"text",IMAGE:"image",VIDEO:"video",AUDIO:"audio",FILE:"file",ROBOT_TEXT:"robot_text",LOCATION:"location",FORCED_FETCH_MESSAGE:"forced_fetch_message",RETAIL_PRODUCT_SUBSCRIPTION:"retail_product_subscription",RETAIL_PROMOTION:"retail_promotion",RETAIL_CANCELLATION:"retail_cancellation",RETAIL_SHIPMENT:"retail_shipment",SHIPMENT_TRACKING_EVENT:"shipment_tracking_event",AIRLINE_CHECKIN_REMINDER:"airline_checkin_reminder",AIRLINE_BOARDING_PASS:"airline_boarding_pass",AIRLINE_CHECKIN:"airline_checkin",AIRLINE_BOARDINGPASS:"airline_boardingpass",AIRLINE_UPDATE:"airline_update",AIRLINE_ITINERARY:"airline_itinerary",CONTENT_SUBSCRIPTION:"content_subscription",AD_ADMIN_TEXT:"ad_admin_text",AD_TEXT:"ad_text",AD_BUBBLE:"ad_bubble",NON_AD:"non_ad",UNKNOWN:"unknown",OTHER:"other",GENERIC:"generic",BUTTON:"button",RECEIPT:"receipt",GENERIC_LEGACY:"generic_legacy",RIDE_INTENT:"ride_intent",RIDE_SIGNUP:"ride_signup",RIDE_WELCOME:"ride_welcome",RIDE_ORDER_CONFIRMATION:"ride_order_confirmation",RIDE_REQUESTED:"ride_requested",RIDE_DRIVER_ON_THE_WAY:"ride_driver_on_the_way",RIDE_NO_DRIVER:"ride_no_driver",RIDE_DRIVER_ARRIVING:"ride_driver_arriving",RIDE_DRIVER_CANCELED:"ride_driver_canceled",RIDE_RIDER_CANCELED:"ride_rider_canceled",RIDE_COMPLETE:"ride_complete",RIDE_ADMIN_MESSAGE:"ride_admin_message",RIDE_RECEIPT:"ride_receipt",GET_RIDE:"give_get_ride",GIVE_RIDE:"send_give_get_ride",LINK:"link_admin_message",UNLINK:"unlink_admin_message",BLOCK_ALL:"block_all_admin_message",UNBLOCK_ALL:"unblock_all_admin_message",BLOCK_PROMOTION:"block_promotion_admin_message",UNBLOCK_PROMOTION:"unblock_promotion_admin_message",INITIAL_PROMOTION:"initial_promotion_admin_message",WEAK_CONSENT_ADMIN_MESSAGE:"weak_consent_admin_message"};},null);
__d("StickerAssetType",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={IMAGE:"BestEffortImage",SPRITE:"SpriteImage",PADDED_SPRITE:"PaddedSpriteImage"};},null);
__d('TypingDetector',['ArbiterMixin','Event','Input','Run','SubscriptionsHandler','TypingStates','createObjectFrom','emptyFunction'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){this._input=i;this._ignoreKeys={};this._getValueFn=j;}Object.assign(h.prototype,c('ArbiterMixin'),{_timeout:7000,_currentState:c('TypingStates').INACTIVE,init:function(){this.init=c('emptyFunction');this.reset();this._subscriptions=new (c('SubscriptionsHandler'))();this._subscriptions.addSubscriptions(c('Event').listen(this._input,'keyup',this._update.bind(this)),c('Run').onUnload(this._onunload.bind(this)));},reset:function(){clearTimeout(this._checkTimer);this._checkTimer=null;this._lastKeystrokeAt=null;this._currentState=c('TypingStates').INACTIVE;},setIgnoreKeys:function(i){this._ignoreKeys=c('createObjectFrom')(i);},destroy:function(){this._subscriptions.release();},_onunload:function(){if(this._currentState==c('TypingStates').TYPING)this._transition(c('TypingStates').QUITTING);},_update:function(event){var i=c('Event').getKeyCode(event),j=this._currentState;if(!this._ignoreKeys[i]){var k=this._getValueFn?this._getValueFn():c('Input').getValue(this._input);if(k.trim().length===0){if(j==c('TypingStates').TYPING)this._transition(c('TypingStates').INACTIVE);}else if(j==c('TypingStates').TYPING){this._recordKeystroke();}else if(j==c('TypingStates').INACTIVE){this._transition(c('TypingStates').TYPING);this._recordKeystroke();}}},_transition:function(i){this.reset();this._currentState=i;this.inform('change',i);},_recordKeystroke:function(){this._lastKeystrokeTime=Date.now();if(!this._checkTimer)this._checkTimer=setTimeout(this._checkTyping.bind(this),this._timeout);},_checkTyping:function(){var i=this._lastKeystrokeTime+this._timeout,j=Date.now();if(j>i){this._transition(c('TypingStates').INACTIVE);}else{clearTimeout(this._checkTimer);this._checkTimer=setTimeout(this._checkTyping.bind(this),i-j+10);}}});f.exports=h;},null);
__d('TypingDetectorController',['AsyncRequest','AvailableList','AvailableListConstants','ChatVisibility','Keys','MercuryServerRequestsConfig','TypingDetector','TypingStates','emptyFunction','ifRequired','setTimeoutAcrossTransitions','shield'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j,k,l,m,n){this.userID=i;this.input=j;this.source=k;this.threadID=m;this.remoteState=c('TypingStates').INACTIVE;this.notifyTimer=null;l=l||{};this.notifyDelay=l.notifyDelay||this.notifyDelay;this._typingDetector=new (c('TypingDetector'))(j,n);this._typingDetector.init(l);this._typingDetector.subscribe('change',this._stateChange.bind(this));}h.prototype.setUserAndThread=function(i,j){if(this.userID!==i||this.threadID!==j){this.resetState();this.userID=i;this.threadID=j;}};h.prototype.setIgnoreEnter=function(i){var j=i?[c('Keys').RETURN]:[];this._typingDetector.setIgnoreKeys(j);};h.prototype.resetState=function(){this._notifyState(c('TypingStates').INACTIVE);this.remoteState=c('TypingStates').INACTIVE;this._typingDetector.reset();clearTimeout(this.notifyTimer);this.notifyTimer=null;};h.prototype.destroy=function(){this.resetState();this._typingDetector.destroy();};h.prototype._stateChange=function(i,j){if(j!=c('TypingStates').QUITTING){clearTimeout(this.notifyTimer);this.notifyTimer=c('setTimeoutAcrossTransitions')(c('shield')(this._notifyState,this,j),this.notifyDelay);}else this._notifyState(j,true);};h.prototype._notifyState=function(i,j){if(!this.userID&&!this.threadID||!c('ChatVisibility').isOnline()||i===this.remoteState||c('ifRequired')('ChannelConnection',function(k){return k.disconnected();},function(){return true;}))return;this._sendRequest(i,this.userID,j);};h.prototype._sendRequest=function(i,j,k){this.remoteState=i;var l={typ:i,to:j,source:this.source,thread:this.threadID},m=new (c('AsyncRequest'))().setHandler(this._onTypResponse.bind(this,j)).setErrorHandler(c('emptyFunction')).setData(l).setURI('/ajax/messaging/typ.php').setAllowCrossPageTransition(true).setOption('asynchronous_DEPRECATED',!k);if(c('MercuryServerRequestsConfig').msgrRegion)m.setRequestHeader('X-MSGR-Region',c('MercuryServerRequestsConfig').msgrRegion);m.send();};h.prototype._onTypResponse=function(i,j){var k=j.getPayload()||{};if(k.offline)c('AvailableList').set(i,c('AvailableListConstants').OFFLINE,'typing_response');};Object.assign(h.prototype,{notifyDelay:1000});f.exports=h;},null);
__d('MercuryMessageDeliveryState',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={SENDING:1,SENT:2,DELIVERED:3,ERROR:0,UNKNOWN:-1};f.exports=h;},null);
__d('MercuryMessageInfo',['MercuryActionStatus','MercuryMessageDeliveryState','MercuryViewer'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={isOutbound:function(i){return i.author===c('MercuryViewer').getID();},isInbound:function(i){return !h.isOutbound(i);},isSending:function(i){return (i.status===c('MercuryActionStatus').UNSENT||i.status===c('MercuryActionStatus').UNCONFIRMED||i.status===c('MercuryActionStatus').UNABLE_TO_CONFIRM||i.status===c('MercuryActionStatus').RESENDING);},isSent:function(i){return (i.status===undefined||i.status===c('MercuryActionStatus').SUCCESS);},hasError:function(i){return (i.status===c('MercuryActionStatus').FAILED_UNKNOWN_REASON||i.status===c('MercuryActionStatus').UNABLE_TO_CONFIRM||i.status===c('MercuryActionStatus').ERROR);},getDeliveryState:function(i,j){if(this.hasError(i))return c('MercuryMessageDeliveryState').ERROR;if(this.isSending(i))return c('MercuryMessageDeliveryState').SENDING;if(this.isSent(i)){if(i.timestamp<=j)return c('MercuryMessageDeliveryState').DELIVERED;return c('MercuryMessageDeliveryState').SENT;}return c('MercuryMessageDeliveryState').UNKNOWN;}};f.exports=h;},null);
__d('MercuryErrorInfo',['fbt','MercuryErrorType','MercuryMessageInfo'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={getMessage:function(j){var k='';if(i.isConnectionError(j)){k=h._("This message didn't send.");if(i.isTransient(j))k=h._("{message} Check your internet connection and click to try again.",[h.param('message',k)]);}else{if(j&&j.description){k=j.description;}else k=h._("This message failed to send.");if(i.isTransient(j))k=h._("{message} Click to send again.",[h.param('message',k)]);}return k;},isConnectionError:function(j){if(j&&j.type==c('MercuryErrorType').TRANSPORT)return j.code===1001||j.code===1004||j.code===1006;return false;},isTransient:function(j){return j&&j.is_transient;},isPermanent:function(j){return j?!this.isTransient(j):false;},hasErrorStatus:function(j){return c('MercuryMessageInfo').hasError(j);}};f.exports=i;},null);
__d('MercuryMessageError.react',['cx','CurrentUser','ImmutableObject','Link.react','MercuryErrorInfo','MercuryMessageActions','React','joinClasses'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'MercuryMessageError',propTypes:{authorFBID:i.string,message:i.instanceOf(c('ImmutableObject')).isRequired},getDefaultProps:function(){return {authorFBID:c('CurrentUser').getID()};},render:function(){var k=this.props.message,l=k.error_data;return (c('React').createElement(c('Link.react'),babelHelpers['extends']({},this.props,{href:'#',className:c('joinClasses')(this.props.className,this._getClassNameFromStatus(k)),tabIndex:c('MercuryErrorInfo').isTransient(l)?0:null,onClick:this.messageResend}),c('React').createElement('i',{className:"_2fs1"}),c('React').createElement('span',{dangerouslySetInnerHTML:{__html:this._getTextFromStatus(k)}})));},messageResend:function(k){k.preventDefault();var l=this.props.message,m=l.error_data;if(c('MercuryErrorInfo').isTransient(m))c('MercuryMessageActions').getForFBID(this.props.authorFBID).resend(this.props.message);},_getClassNameFromStatus:function(k){if(c('MercuryErrorInfo').hasErrorStatus(k)){return "_2fs2"+(' '+"_2fs3")+(c('MercuryErrorInfo').isTransient(k.error_data)?' '+"_2fs4":'')+(c('MercuryErrorInfo').isPermanent(k.error_data)?' '+"_2fs5":'');}else return "_2fs6 _2fs2";},_getTextFromStatus:function(k){var l='',m=k.error_data;if(c('MercuryErrorInfo').hasErrorStatus(k))l=c('MercuryErrorInfo').getMessage(m);if(typeof l==='object'&&l.__html)l=l.__html;return l;}});f.exports=j;},null);
__d('PhotoStoreCore',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={actions:{UPDATE:'update'},_photoCache:{},_postCreateCallbacks:{},getPhotoCache:function(i){if(!this._photoCache[i])throw new Error('Photo cache requested for unknown set ID');return this._photoCache[i];},hasBeenCreated:function(i){return !!this._photoCache[i];},clearSetCache:function(i){delete this._photoCache[i];delete this._postCreateCallbacks[i];},getByIndex:function(i,j,k){this.getPhotoCache(i).getItemAtIndex(j,k);},getByIndexImmediate:function(i,j){if(this._photoCache[i])return this._photoCache[i].getItemAtIndexImmediate(j);return undefined;},getItemsInAvailableRange:function(i){var j=this.getAvailableRange(i),k=[];for(var l=j.offset;l<j.length;l++)k.push(this.getByIndexImmediate(i,l));return k;},getItemsAfterIndex:function(i,j,k,l){var m=this.getCursorByIndexImmediate(i,j);this.fetchForward(i,m,k,l);},getAllByIDImmediate:function(i){var j=Object.keys(this._photoCache);return j.map(function(k){return this.getByIndexImmediate(k,this.getIndexForID(k,i));}.bind(this)).filter(function(k){return !!k;});},getIndexForID:function(i,j){if(this._photoCache[i])return this._photoCache[i].getIndexForID(j);return undefined;},getEndIndex:function(i){var j=this.getAvailableRange(i);return j.offset+j.length-1;},getCursorByIndexImmediate:function(i,j){var k=this.getByIndexImmediate(i,j);if(k)return this._photoCache[i].getCursorForID(k.id);return undefined;},hasNextPage:function(i){var j=this.getCursorByIndexImmediate(i,this.getEndIndex(i));return this.getPhotoCache(i).hasNextPage(j);},getAvailableRange:function(i){return this.getPhotoCache(i).getAvailableRange();},hasLooped:function(i){return this.getPhotoCache(i).hasLooped();},fetchForward:function(i,j,k,l){this.getPhotoCache(i).getItemsAfterCursor(j,k,l);},fetchBackward:function(i,j,k,l){this.getPhotoCache(i).getItemsBeforeCursor(j,k,l);},executePostCreate:function(i,j){if(this._photoCache[i]){j&&j();}else this._postCreateCallbacks[i]=j;},runPostCreateCallback:function(i){var j=this._postCreateCallbacks[i];if(j){j();delete this._postCreateCallbacks[i];}},setPreFetchCallback:function(i,j){this.getPhotoCache(i).setPreFetchCallback(j);},updateData:function(i){var j=i.set_id;if(!this._photoCache[j]){this._photoCache[j]=new i.cache_class(i);this.runPostCreateCallback(j);}else if(i.query_metadata.action==h.actions.UPDATE){this._photoCache[j].updateData(i);}else this._photoCache[j].addData(i);},updateFeedbackData:function(i){var j=Object.keys(i);j.forEach(function(k){return h.getAllByIDImmediate(k).forEach(function(l){l.feedback=i[k].feedback;});});},reset:function(){Object.keys(this._photoCache).forEach(function(i){return this.clearSetCache(i);}.bind(this));}};f.exports=h;},null);
__d('ChatEditParticipantsUtils',['AsyncDialog','AsyncRequest','MercuryIDs','MercuryThreadIDMap','URI'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('MercuryThreadIDMap').get(),i={showParticipantsModal:function(j){if(!c('MercuryIDs').isGroupChat(j))return;h.getServerIDFromClientID(j,function(k){c('AsyncDialog').send(new (c('AsyncRequest'))(new (c('URI'))('/ajax/browser/dialog/multichat_members/').addQueryData({id:k})));});}};f.exports=i;},null);
__d('MessengerAdminGroupUtils',['fbt','MercuryConfig','MercuryIDs','MessengerApprovalModeTypes','MessengerJoinableModeType'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i={isJoinableAndOpenThread:function(j){return !!(c('MercuryConfig').JoinableMasterGK&&j&&j.joinable_mode&&j.joinable_mode.mode===c('MessengerJoinableModeType').JOINABLE&&j.approval_mode===c('MessengerApprovalModeTypes').OPEN);},_isThreadJoinable:function(j){return !!(c('MercuryConfig').JoinableMasterGK&&j&&j.joinable_mode&&j.joinable_mode.mode===c('MessengerJoinableModeType').JOINABLE);},isOwner:function(j,k){return j&&this._isThreadJoinable(k);},canMakeOthersAdmins:function(j,k,l){return this.isOwner(j,l)&&!k;},canRemoveAdmin:function(j,k,l){return this.isOwner(j,l)&&k;},canRemoveFromGroup:function(j,k){return this.isOwner(j,k)||!this._isThreadJoinable(k);},showParticipantsModal:function(j,k,l){return this._isThreadJoinable(l)&&!j&&!k;},isViewerAdmin:function(j,k){return this.isAdmin(j,c('MercuryIDs').getParticipantIDFromUserID(k));},isAdmin:function(j,k){return j!==null&&j!==undefined&&j.indexOf(k)!==-1;},getLeaveGroupBodyText:function(j,k){return this.isOwner(j,k)?h._("Leaving this group will remove you as an owner and allow other members to manage the group. You will no longer be able to send or receive new messages."):h._("You will stop receiving messages from this conversation and people will see that you left.");},getLeaveGroupTitleText:function(j,k){return this.isOwner(j,k)?h._("Leave this conversation?"):h._("Leave Conversation?");},getLeaveGroupButtonText:function(j,k){return this.isOwner(j,k)?h._("Leave converstaion"):h._("Leave");},getMakeOwnerBodyText:function(j,k){return j?h._("As a group owner, you will be able to manage group ownership and remove members from the conversation. Only owners will be able to add other owners."):h._("As a group owner, \"{owner's name}\" will be able to manage group ownership and remove members from the conversation. They will be able to remove ownership from other owners.",[h.param('owner\'s name',k)]);},getMakeOwnerTitleText:function(j){return j?h._("Become group owner?"):h._("Add group owner?");},getMakeOwnerButtonText:function(j){return j?h._("Become owner"):h._("Make owner");},getRemoveOwnerBodyText:function(j,k,l){var m=void 0;if(j&&k){m=h._("You will no longer manage group ownership and remove members from this conversation. You will still be a participant in the group. Any other member will be able to own the group.");}else if(j&&!k){m=h._("You will no longer manage group ownership and remove members from this conversation. You will still be a participant in the group.");}else m=h._("\"{owner's name}\" will no longer manage group ownership and remove members from the conversation. They will still be a participant in the group.",[h.param('owner\'s name',l)]);return m;}};f.exports=i;},null);
__d('MessengerHotLikePreviewEvents',['mixInEventEmitter'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={START:'start',STOP:'stop',POP:'pop',REMOVE:'remove',FINISH_ANIMATION:'finish_animation'};c('mixInEventEmitter')(h,{start:true,stop:true,pop:true,remove:'remove',finish_animation:'finish_animation'});f.exports=h;},null);
__d('MessengerHotLikeUtils',['EmojiLikeConstants','StickerAssetType','StickerConstants','XStickerAssetController'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={SizeTimes:{small:1000,medium:2000,large:3000},getStickerIDForTime:function(i){var j=null;switch(true){case i<this.SizeTimes.small:j=c('StickerConstants').HOT_LIKE_SMALL_STICKER_ID;break;case i<this.SizeTimes.medium:j=c('StickerConstants').HOT_LIKE_MEDIUM_STICKER_ID;break;case i<this.SizeTimes.large:j=c('StickerConstants').HOT_LIKE_LARGE_STICKER_ID;break;}return j;},getEmojiSizeForTime:function(i){var j=null;if(i<this.SizeTimes.small){j=c('EmojiLikeConstants').size.SMALL;}else if(i<this.SizeTimes.medium){j=c('EmojiLikeConstants').size.MEDIUM;}else if(i<this.SizeTimes.large)j=c('EmojiLikeConstants').size.LARGE;return j;},getMetadataForHotLike:function(i){var j=void 0;switch(i){case c('StickerConstants').HOT_LIKE_LARGE_STICKER_ID:j=120;break;case c('StickerConstants').HOT_LIKE_MEDIUM_STICKER_ID:j=84;break;case c('StickerConstants').HOT_LIKE_SMALL_STICKER_ID:j=35;break;case c('EmojiLikeConstants').size.LARGE:j=64;break;case c('EmojiLikeConstants').size.MEDIUM:j=64;break;case c('EmojiLikeConstants').size.SMALL:j=32;break;}return j?{height:j,width:j}:undefined;},getPreviewURI:function(){return c('XStickerAssetController').getURIBuilder().setInt('sticker_id',c('StickerConstants').HOT_LIKE_LARGE_STICKER_ID).setEnum('image_type',c('StickerAssetType').IMAGE).getURI().toString();},getURIWithID:function(i){return c('XStickerAssetController').getURIBuilder().setInt('sticker_id',i).setEnum('image_type',c('StickerAssetType').IMAGE).getURI().toString();},getCustomEmojiFromThread:function(i){return i&&i.custom_like_icon;}};f.exports=h;},null);
__d('MessengerContextBannerBootloader',['BootloadedComponent.react','CurrentUser','DOM','JSResource','React','ReactDOM'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(k,l,m,n,o){var p=c('DOM').create('div');i(k,l,function(q){c('ReactDOM').render(q,p,m(p));},n,o);}function i(k,l,m,n,o,p){p=babelHelpers['extends']({left:0,position:'absolute',right:0,top:0},p);j({otherUserFBIDs:n&&[n],threadID:k,style:p},l,m,o);}function j(k,l,m,n){m(c('React').createElement(c('BootloadedComponent.react'),babelHelpers['extends']({bootloadPlaceholder:c('React').createElement('div',{style:{height:80}}),bootloadLoader:c('JSResource')('MessengerContextBannerContainer.react').__setRef('MessengerContextBannerBootloader'),location:l,onResize:n,viewer:c('CurrentUser').getID()},k)));}f.exports={bootload:h,getBootloadedComponent:i};},null);
__d('MessageRequestUtils',['MessagingTag'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={isMessageRequest:function(i){return i.folder===c('MessagingTag').PENDING||i.folder===c('MessagingTag').OTHER;},isFiltered:function(i){return i.folder===c('MessagingTag').OTHER;}};f.exports=h;},null);
__d('MercuryTypingReceiver',['Arbiter','ChannelConstants','FBID','MercuryActionType','MercuryIDs','MercuryPayloadSource','MercuryDispatcher','MercurySingletonMixin','MercuryThreadIDMap','MercuryViewer','TypingStates','isEmpty','mixInEventEmitter','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('MercuryThreadIDMap').get(),i=30000;function j(k){'use strict';this.$MercuryTypingReceiver1=null;this.$MercuryTypingReceiver2={};this.$MercuryTypingReceiver3=c('MercuryDispatcher').getForFBID(k);this.$MercuryTypingReceiver3.subscribe('update-typing-state',function(m,n){var o=n.payload_source;if(o!=c('MercuryPayloadSource').CLIENT_CHANNEL_MESSAGE)return;var p=n.actions;if(!p||!p.length)return;var q=c('MercuryActionType').USER_GENERATED_MESSAGE;p.forEach(function(r){if(r.action_type==q&&r.author!=c('MercuryViewer').getID())this.$MercuryTypingReceiver4(r.thread_id,r.author);}.bind(this));}.bind(this));var l;if(c('FBID').isUser(k)){l=[c('ChannelConstants').getArbiterType('typ'),c('ChannelConstants').getArbiterType('ttyp')];}else l=[c('ChannelConstants').getArbiterType('page_typing')];c('Arbiter').subscribe(l,function(m,n){var o=n.obj,p=this.$MercuryTypingReceiver5(o);if(p){var q=c('MercuryIDs').getParticipantIDFromUserID(o.from.toString());if(o.st==c('TypingStates').TYPING){this.$MercuryTypingReceiver2[p]=this.$MercuryTypingReceiver2[p]||{};var r=this.$MercuryTypingReceiver2[p][q];this.$MercuryTypingReceiver2[p][q]=Date.now();if(!this.$MercuryTypingReceiver1)this.$MercuryTypingReceiver1=c('setTimeoutAcrossTransitions')(function(){this.$MercuryTypingReceiver6();}.bind(this),3000);!r&&this.$MercuryTypingReceiver7(p);}else if(o.st==c('TypingStates').INACTIVE)this.$MercuryTypingReceiver4(p,q);}}.bind(this));}j.prototype.$MercuryTypingReceiver8=function(k){'use strict';var l=this.$MercuryTypingReceiver2[k]||{},m=Object.keys(l);m.sort(function(n,o){return l[n]-l[o];});return m;};j.prototype.$MercuryTypingReceiver6=function(){'use strict';this.$MercuryTypingReceiver1=null;var k=Date.now(),l={},m=false;for(var n in this.$MercuryTypingReceiver2){var o=false;for(var p in this.$MercuryTypingReceiver2[n]||{})if(this.$MercuryTypingReceiver2[n][p]<k-i){delete this.$MercuryTypingReceiver2[n][p];o=true;}else m=true;if(o)l[n]=this.$MercuryTypingReceiver8(n);}if(!c('isEmpty')(l))this.$MercuryTypingReceiver9(l);if(m)this.$MercuryTypingReceiver1=c('setTimeoutAcrossTransitions')(function(){this.$MercuryTypingReceiver6();}.bind(this),3000);};j.prototype.$MercuryTypingReceiver4=function(k,l){'use strict';if(k in this.$MercuryTypingReceiver2)if(l in this.$MercuryTypingReceiver2[k]){delete this.$MercuryTypingReceiver2[k][l];this.$MercuryTypingReceiver7(k);}};j.prototype.$MercuryTypingReceiver9=function(k){'use strict';this.releaseHeldEventType('state-changed');this.emitAndHold('state-changed',k);};j.prototype.$MercuryTypingReceiver7=function(k){'use strict';var l={};l[k]=this.$MercuryTypingReceiver8(k);this.$MercuryTypingReceiver9(l);};j.prototype.$MercuryTypingReceiver5=function(k){'use strict';if(k.thread_fbid)return h.getClientIDFromServerIDNow(k.thread_fbid.toString());if(k.type==='typ'||k.type==='page_typing')return c('MercuryIDs').getThreadIDFromUserID(k.from.toString());return null;};c('mixInEventEmitter')(j,{'state-changed':true});Object.assign(j,c('MercurySingletonMixin'));f.exports=j;},null);
__d('MercuryIndicatorController',['fbt','ArbiterMixin','DOM','MercuryActionType','MercuryDelayedRoger','MercuryIDs','MercuryMessageSourceTags','MercuryParticipants','MercuryRoger','MercuryThreads','MercuryTypingReceiver','MercuryViewer','WorkModeConfig','arrayContains','formatDate','removeFromArray'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('MercuryDelayedRoger').get(),j=c('MercuryRoger').get(),k=c('MercuryThreads').get(),l=c('MercuryTypingReceiver').get(),m=[];function n(o){this._threadID=o;this._canonicalUser=c('MercuryIDs').getUserIDFromThreadID(o);m.push(this);}Object.assign(n.prototype,c('ArbiterMixin'),{destroy:function(){c('removeFromArray')(m,this);},setLastMessage:function(o){this._lastMsg=o;this._handleStateChange();},_informStateChanged:function(o){if(o.activity=='none'&&this._currentActivity=='none')return;if(this._lastMsg&&c('MercuryViewer').isViewer(this._lastMsg.author))o.self_authored=true;this._currentActivity=o.activity;this.inform('state-changed',o);},_notifySentFrom:function(){var o,p,q=this._lastMsg.source_tags||[];if(c('arrayContains')(q,c('MercuryMessageSourceTags').MESSENGER)){if(!c('WorkModeConfig').is_work_user){o=c('DOM').create('a',{href:'/mobile/messenger','class':'fcg',target:'_blank'},h._("Sent from Messenger"));}else o=c('DOM').create('a',{href:'/mobile','class':'fcg',target:'_blank'},h._("Sent from Work Chat"));p='sentFromMobile';}else if(c('arrayContains')(q,c('MercuryMessageSourceTags').MOBILE)){o=c('DOM').create('a',{href:'/mobile','class':'fcg',target:'_blank'},h._("Sent from Mobile"));p='sentFromMobile';}else if(c('arrayContains')(q,c('MercuryMessageSourceTags').EMAIL)){o=h._("Sent from email");p='sentFromEmail';}else{this._informStateChanged({activity:'none'});return;}this._informStateChanged({activity:p,text:o});},_notifySeenTimestamp:function(o){var p=j.getSeenTimestamp(this._threadID,o[0])*.001,q=Date.now()*.001,r;if(p<q-518400){r='M j';}else if(p<q-86400){r='D g:ia';}else r='g:ia';this._informStateChanged({activity:'seen-timestamp',text:h._("Seen {timestamp}",[h.param('timestamp',c('formatDate')(p,r))])});},_nameNormalizer:function(o){var p;c('MercuryParticipants').getMulti(o,function(q){function r(t){if(q[t]!==undefined&&q[t].short_name){return q[t].short_name.toLowerCase();}else return t;}var s=o.map(r);p=function(t){var u=r(t),v=s.indexOf(u)!==s.lastIndexOf(u);return v?q[t].name:q[t].short_name;};});return p;},_seenByEveryone:function(o,p,q){var r=q?q.participants.length:0,s=o.length;if(p.author!=c('MercuryViewer').getID()&&(!q||q.participants.indexOf(p.author)>-1))s++;return r>2&&s>=r-1;},_notifySeenBy:function(o){var p=this._lastMsg,q=true;c('MercuryParticipants').getMulti(o,function(r){q=false;if(this._lastMsg!=p)return;var s=k.getThreadMetaNow(this._threadID),t=null;if(s&&s.custom_nickname)t=s.custom_nickname;var u=[];for(var v in r){var w=r[v],x=w.short_name;if(t&&t[w.fbid])x=t[w.fbid];u[v]=x;}var y,z=false;if(this._seenByEveryone(o,p,s)){y=h._("Seen by everyone");}else if(o.length==1){y=h._("Seen by {user}",[h.param('user',u[o[0]])]);}else if(o.length==2){y=h._("Seen by {user1}, {user2}",[h.param('user1',u[o[0]]),h.param('user2',u[o[1]])]);}else if(o.length==3){y=h._("Seen by {user1}, {user2}, {user3}",[h.param('user1',u[o[0]]),h.param('user2',u[o[1]]),h.param('user3',u[o[2]])]);}else if(o.length>3){var aa=Object.keys(r).length-2,ba=h._({"*":"{num} more"},[h.param('num',aa,[0])]),ca=c('DOM').create('span',{className:'more'},ba);y=h._("Seen by {user1}, {user2}, {=num more link}",[h.param('user1',u[o[0]]),h.param('user2',u[o[1]]),h.param('=num more link',ca)]);z=true;}this._informStateChanged({activity:'seen-by',text:y,seenBy:o,tooltip:z});}.bind(this));q&&this._informStateChanged({activity:'none'});},_notifyTyping:function(o){var p=this._lastMsg,q=true;c('MercuryParticipants').getMulti(o,function(r){q=false;if(this._lastMsg!=p)return;var s=k.getThreadMetaNow(this._threadID),t=s?s.participants.length:0,u;if(s)u=this._nameNormalizer(s.participants);if(!u)u=function(aa){return r[aa].short_name;};var v,w=false;if(t>2&&o.length>=t-1){v=h._("Everyone is typing...");}else if(o.length==1){v=h._("{name} is typing...",[h.param('name',r[o[0]].short_name)]);}else if(o.length==2){v=h._("{user1} and {user2} are typing...",[h.param('user1',r[o[0]].short_name),h.param('user2',r[o[1]].short_name)]);}else if(o.length==3){v=h._("{user1}, {user2} and {user3} are typing...",[h.param('user1',r[o[0]].short_name),h.param('user2',r[o[1]].short_name),h.param('user3',r[o[2]].short_name)]);}else if(o.length>3){var x=Object.keys(r).length-2,y=h._({"*":"{num} more"},[h.param('num',x,[0])]),z=c('DOM').create('a',{href:'#'},y);v=h._("{user1}, {user2} and {=num more link} are typing...",[h.param('user1',r[o[0]].short_name),h.param('user2',r[o[1]].short_name),h.param('=num more link',z)]);w=true;}this._informStateChanged({activity:'typing',text:v,typing:o,tooltip:w});}.bind(this));q&&this._informStateChanged({activity:'none'});},_handleStateChange:function(){var o=c('MercuryActionType').LOG_MESSAGE;if(!this._lastMsg||this._lastMsg.action_type==o){this._informStateChanged({activity:'none'});return;}if(this._typing&&this._typing.length){this._notifyTyping(this._typing);return;}if(this._canonicalUser&&this._lastMsg.author!=c('MercuryViewer').getID()){this._notifySentFrom();return;}var p=i.getSeenBy(this._threadID,true);if(p.length)if(this._canonicalUser){this._notifySeenTimestamp(p);return;}else{this._notifySeenBy(p);return;}this._informStateChanged({activity:'none'});}});l.addRetroactiveListener('state-changed',function(o){m.forEach(function(p){var q=o[p._threadID];if(q!==undefined){p._typing=q;p._handleStateChange();}});});i.subscribe('state-changed',function(o,p){m.forEach(function(q){p[q._threadID]&&q._handleStateChange();});});f.exports=n;},null);
__d('MercuryLastMessageIndicator.react',['cx','DOM','MercuryIndicatorController','MercuryParticipants','React','ReactDOM','TooltipData','emptyFunction','joinClasses'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'MercuryLastMessageIndicator',propTypes:{hideTyping:i.bool,indicatorWillShow:i.func,indicatorDidShow:i.func,lastMessage:i.object,threadID:i.string.isRequired},getDefaultProps:function(){return {indicatorWillShow:c('emptyFunction'),indicatorDidShow:c('emptyFunction')};},getInitialState:function(){return {data:{}};},componentDidMount:function(){this._setup(this.props);},componentWillReceiveProps:function(k){if(k.threadID!=this.props.threadID){this._destroy();this._setup(k);}else if(k.lastMessage!=this.props.lastMessage)this._controller.setLastMessage(k.lastMessage);},componentWillUpdate:function(k,l){if(this.isVisible(k,l))this.props.indicatorWillShow();},componentDidUpdate:function(){if(!this.isVisible())return;this.setText();this.setTooltip();this.props.indicatorDidShow();},componentWillUnmount:function(){this._destroy();},render:function(){return (c('React').createElement('div',{className:this.getRootClass()},c('React').createElement('div',{className:"_510h"}),c('React').createElement('span',{className:"_510f",ref:'text'},'Â ')));},getRootClass:function(){var k="_510g"+(this.state.data.self_authored?' '+"_510e":''),l=this.state.data.activity,m=null;if(String(l).startsWith('seen')){m='seen';}else if(l=='typing'){m=this.props.hideTyping?null:l;}else m=l;return c('joinClasses')(k,m,this.props.className);},isVisible:function(k,l){k=k||this.props;l=l||this.state;return (l.data&&l.data.activity!='none'&&!(k.hideTyping&&l.data.activity=='typing'));},setText:function(){if(this.state.data.text)c('DOM').setContent(c('ReactDOM').findDOMNode(this.refs.text),this.state.data.text);},setTooltip:function(){if(this.state.data.activity=='seen-by'&&this.state.data.tooltip)c('MercuryParticipants').getMulti(this.state.data.seenBy,function(k){var l=c('DOM').create('div',null,this.state.data.seenBy.map(function(m){return c('DOM').create('div',null,k[m].name);}));c('TooltipData').set(c('DOM').find(c('ReactDOM').findDOMNode(this),'span.more'),l,'above','center');}.bind(this));},_setup:function(k){this._controller=new (c('MercuryIndicatorController'))(k.threadID);this._subscription=this._controller.subscribe('state-changed',function(l,m){return this.setState({data:m});}.bind(this));k.lastMessage&&this._controller.setLastMessage(k.lastMessage);},_destroy:function(){this._subscription.unsubscribe();this._controller.destroy();}});f.exports=j;},null);
__d('WebMessengerThreadPermalinks',['MercuryIDs','MessagingTag','URI','WebMessengerPermalinkConstants','WWWBase','requireWeak'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={getThreadURI:function(m,n,o){if(c('MercuryIDs').isCanonical(m)){j(m,n,o);}else k(m,n,o);},getThreadURIFromUserID:function(m,n){return i(m,n);}};function i(m,n){var o=new (c('URI'))(c('WWWBase').uri);o.setPath(l(n)+'/'+m);return o.toString();}function j(m,n,o){var p=c('MercuryIDs').tokenize(m).value;n&&n(i(p,o));}function k(m,n,o){c('requireWeak')('MercuryThreadIDMap',function(p){var q=p.get();q.getServerIDFromClientID(m,function(r){var s=new (c('URI'))(c('WWWBase').uri);s.setPath(c('WebMessengerPermalinkConstants').getURIPathForThreadID(r,l(o)));n&&n(s.toString());});});}function l(m){var n=c('WebMessengerPermalinkConstants').BASE_PATH;if(m&&m!=c('MessagingTag').INBOX)n+='/'+m;return n;}f.exports=h;},null);
__d('MercuryMessageRendererUtils',['cx','invariant','HovercardLink','MercuryConfig','MercuryEmojiConfig','MercuryViewer','React'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j={getLinkToParticipant:function(k,l){var m=k.fbid,n=c('HovercardLink').constructEndpoint({id:m}),o=l&&l.custom_nickname&&l.custom_nickname[m];if(o&&c('MercuryConfig').MessengerNewEmojiGK&&c('MercuryEmojiConfig').MessengerTextWithEmoticonsModule){var p=c('MercuryEmojiConfig').MessengerTextWithEmoticonsModule;o=c('React').createElement(p,{renderEmoticons:true,renderEmoji:true,text:o});}var q=o?o:k.name;if(k.href)return (c('React').createElement('a',{className:"_5wzt",href:k.href,'data-hovercard':n},q));return q;},moveCurrentUserToFront:function(){var k=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];!k?i(0):void 0;var l=k.indexOf(c('MercuryViewer').getID());if(l>0){var m=k.filter(function(n){return n!==c('MercuryViewer').getID();});return [c('MercuryViewer').getID()].concat(m);}return k;}};f.exports=j;},null);
__d('PhotoStore',['Arbiter','PhotoStoreCore'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();c('Arbiter').subscribe('update-photos',function(h,i){c('PhotoStoreCore').updateData(i);});f.exports=c('PhotoStoreCore');},null);
__d('MessagesViewer',['AsyncRequest','Bootloader','DOM','MessagesViewerSetID','PhotoStore','React','ReactDOM','Run','emptyFunction','ge'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={bootstrapWithElem:function(k){h.bootstrapWithConfig({fbid:k.getAttribute('data-fbid'),dimensions:k.getAttribute('data-dimensions'),src:k.getAttribute('href'),endpoint:k.getAttribute('data-endpoint'),disablePaging:k.getAttribute('data-disablepaging')},k);},bootstrapWithConfig:function(k,l){var m=k.setID;if(!m)m=c('MessagesViewerSetID').MESSAGES;j(function(n,o){i(c('React').createElement(n,{actorid:k.actorid,dimensions:[k.dimensions],disablepaging:k.disablePaging,disableForward:k.disableForward,open:true,photoid:k.fbid,reverse:false,rootClassName:k.rootClassName,setid:m,snapToPhoto:k.snapToPhoto,thumbsrc:k.src}));if(!c('PhotoStore').hasBeenCreated(m)&&k.endpoint){var p=new (c('AsyncRequest'))(k.endpoint);if(l)p.setRelativeTo(l);p.send();}});},renderVideo:function(k){j(function(l,m){i(c('React').createElement(m,k));});},preload:function(){c('Run').onAfterLoad(function(){return j(c('emptyFunction'));});}};function i(k){var l=c('ge')('messages_viewer');if(!l){l=c('DOM').create('div',{id:'messages_viewer'});document.body.appendChild(l);}k=c('ReactDOM').render(k,l);k.subscribeOnce('close',function(){c('ReactDOM').unmountComponentAtNode(l);});}function j(k){c('Bootloader').loadModules(["SpotlightMessagesViewer","MessagingVideoViewer.react"],k,'MessagesViewer');}f.exports=h;},null);
__d('MercuryLogMessageRenderer',['cx','fbt','invariant','ix','Bootloader','CSS','Image.react','MercuryConfig','MercuryEmojiConfig','MercuryViewer','MessagesViewer','MercuryLogMessageType','MessengerAdminGroupUtils','MercuryParticipants','React','ReactDOM','MercuryMessageRendererUtils','TextWithEntities.react','TooltipLink.react','UserAgent'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l={renderText:function(x,y,z){switch(x.log_message_type){case c('MercuryLogMessageType').SUBSCRIBE:if(c('MessengerAdminGroupUtils').isJoinableAndOpenThread(y)){c('Bootloader').loadModules(["MercuryJoinableMessageRenderer"],function(aa){aa.renderText(x,y,z);},'MercuryLogMessageRenderer');}else o(x,z);break;case c('MercuryLogMessageType').UNSUBSCRIBE:t(x,z);break;case c('MercuryLogMessageType').THREAD_NAME:u(x,y,z);break;case c('MercuryLogMessageType').THREAD_IMAGE:v(x,y,z);break;case c('MercuryLogMessageType').WALLPAPER:w(x,z);break;case c('MercuryLogMessageType').GENERIC_ADMIN_TEXT:c('Bootloader').loadModules(["MercuryXMATRenderer"],function(aa){z(aa.renderText(x));},'MercuryLogMessageRenderer');break;default:c('Bootloader').loadModules(["MercurySpecialLogMessageRenderer"],function(aa){aa.renderText(x,z);},'MercuryLogMessageRenderer');break;}},renderIcon:function(x){return (c('React').createElement(c('Image.react'),{className:m(x.log_message_type,x.log_message_data),src:k('images/spacer.gif')}));},renderLegacy:function(x,y,z,aa){m(aa.log_message_type,aa.log_message_data).split(' ').forEach(function(ba){return ba&&c('CSS').addClass(x,ba);});this.renderText(aa,null,function(ba){c('ReactDOM').render(c('React').createElement('span',null,ba),y);});this.renderAttachmentLegacy(z,aa);},renderAttachmentLegacy:function(x,y){if(y.log_message_type===c('MercuryLogMessageType').THREAD_IMAGE)(function(){!y.log_message_data?j(0):void 0;var z=y.log_message_data.image;if(z&&z.preview_url){c('ReactDOM').render(c('React').createElement(c('Image.react'),{className:"_z6a",onClick:function(){return n(z);},src:z.preview_url}),x);c('CSS').show(x);}})();}};f.exports=l;function m(x,y){var z=!!(y&&y.answered);return "_5wzu"+(x===c('MercuryLogMessageType').SUBSCRIBE?' '+"_5wzj":'')+(x===c('MercuryLogMessageType').UNSUBSCRIBE?' '+"_5wzk":'')+(x===c('MercuryLogMessageType').THREAD_NAME?' '+"_5wzl":'')+(x===c('MercuryLogMessageType').THREAD_IMAGE?' '+"_5wzm":'')+(x===c('MercuryLogMessageType').VIDEO_CALL&&z?' '+"_5wzn":'')+(x===c('MercuryLogMessageType').VIDEO_CALL&&!z?' '+"_5wzo":'')+(x===c('MercuryLogMessageType').PHONE_CALL&&z?' '+"_5wzp":'')+(x===c('MercuryLogMessageType').PHONE_CALL&&!z?' '+"_5wzq":'')+(x===c('MercuryLogMessageType').SERVER_ERROR?' '+"_5wzr":'')+(!x?' '+"_2r5l":'');}function n(x){c('MessagesViewer').bootstrapWithConfig({src:x.preview_url,endpoint:x.url,fbid:x.metadata.fbid,dimensions:x.metadata.dimensions,disablePaging:true},null);}function o(x,y){!x.log_message_data?j(0):void 0;var z=c('MercuryMessageRendererUtils').moveCurrentUserToFront(x.log_message_data.added_participants);!z?j(0):void 0;switch(z.length){case 1:p(x,y,z);break;case 2:q(x,y,z);break;case 3:r(x,y,z);break;default:s(x,y,z);break;}}function p(x,y,z){var aa=[x.author,z[0]];c('MercuryParticipants').getMulti(aa,function(ba){if(x.author===c('MercuryViewer').getID()){y(i._("You added {subscriber1}.",[i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[0]]))]));}else if(z[0]===c('MercuryViewer').getID()){y(i._("{actor} added you.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[x.author]))]));}else y(i._("{actor} added {subscriber1}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[x.author])),i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[0]]))]));});}function q(x,y,z){var aa=[x.author].concat(z);c('MercuryParticipants').getMulti(aa,function(ba){if(x.author===c('MercuryViewer').getID()){y(i._("You added {subscriber1} and {subscriber2}.",[i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[0]])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[1]]))]));}else if(z[0]===c('MercuryViewer').getID()){y(i._("{actor} added you and {subscriber2}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[x.author])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[1]]))]));}else y(i._("{actor} added {subscriber1} and {subscriber2}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[x.author])),i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[0]])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[1]]))]));});}function r(x,y,z){var aa=[x.author].concat(z);c('MercuryParticipants').getMulti(aa,function(ba){if(x.author===c('MercuryViewer').getID()){y(i._("You added {subscriber1}, {subscriber2} and {subscriber3}.",[i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[0]])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[1]])),i.param('subscriber3',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[2]]))]));}else if(z[0]===c('MercuryViewer').getID()){y(i._("{actor} added you, {subscriber2} and {subscriber3}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[x.author])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[1]])),i.param('subscriber3',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[2]]))]));}else y(i._("{actor} added {subscriber1}, {subscriber2} and {subscriber3}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[x.author])),i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[0]])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[1]])),i.param('subscriber3',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[z[2]]))]));});}function s(x,y,z){var aa=[x.author].concat(z);c('MercuryParticipants').getMulti(aa,function(ba){function ca(ea){var fa=c('React').createElement('div',null,ea.map(function(ga){return c('React').createElement('div',null,ga.name);}));return (c('React').createElement(c('TooltipLink.react'),{alignH:'center',position:'above',tooltip:fa},i._({"*":"{num} more"},[i.param('num',ea.length,[0])])));}var da=z.map(function(ea){return ba[ea];});if(x.author===c('MercuryViewer').getID()){y(i._("You added {subscriber1}, {subscriber2} and {more_people}.",[i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(da[0])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(da[1])),i.param('more_people',ca(da.slice(2)))]));}else if(z[0]===c('MercuryViewer').getID()){y(i._("{actor} added you, {subscriber2} and {more_people}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[x.author])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(da[1])),i.param('more_people',ca(da.slice(2)))]));}else y(i._("{actor} added {subscriber1}, {subscriber2} and {more_people}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ba[x.author])),i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(da[0])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(da[1])),i.param('more_people',ca(da.slice(2)))]));});}function t(x,y){var z=[x.author];!x.log_message_data?j(0):void 0;var aa=x.log_message_data.removed_participants;!aa?j(0):void 0;var ba=void 0;if(aa.length===1){ba=aa[0];z.push(ba);}c('MercuryParticipants').getMulti(z,function(ca){var da=ca[x.author],ea=ca[ba];if(x.author===c('MercuryViewer').getID()){if(!ba||ba===x.author){y(i._("You left the conversation."));}else y(i._("You removed {name} from the conversation.",[i.param('name',c('MercuryMessageRendererUtils').getLinkToParticipant(ea))]));}else if(!ba||ba===x.author){y(i._("{actor} left the conversation.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(da))]));}else if(ba===c('MercuryViewer').getID()){y(i._("{actor} removed you from the conversation.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(da))]));}else y(i._("{actor} removed {name} from the conversation.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(da)),i.param('name',c('MercuryMessageRendererUtils').getLinkToParticipant(ea))]));});}function u(x,y,z){!x.log_message_data?j(0):void 0;var aa=x.log_message_data.name,ba="_5wzs"+(c('UserAgent').isBrowser('Chrome')?' '+"_4fbd":'');if(x.author===c('MercuryViewer').getID()){if(aa){var ca=c('React').createElement(c('TextWithEntities.react'),{renderEmoticons:true,renderEmoji:true,text:aa});if(c('MercuryConfig').MessengerNewEmojiGK&&c('MercuryEmojiConfig').MessengerTextWithEmoticonsModule){var da=c('MercuryEmojiConfig').MessengerTextWithEmoticonsModule;ca=c('React').createElement(da,{renderEmoticons:true,renderEmoji:true,text:aa});}z(i._("You named the conversation: {name}.",[i.param('name',c('React').createElement('span',{className:ba},ca))]));}else z(i._("You removed the conversation name."));}else c('MercuryParticipants').get(x.author,function(ea){var fa=c('MercuryMessageRendererUtils').getLinkToParticipant(ea,y);if(aa){var ga=c('React').createElement(c('TextWithEntities.react'),{renderEmoticons:true,renderEmoji:true,text:aa});if(c('MercuryConfig').MessengerNewEmojiGK&&c('MercuryEmojiConfig').MessengerTextWithEmoticonsModule){var ha=c('MercuryEmojiConfig').MessengerTextWithEmoticonsModule;ga=c('React').createElement(ha,{renderEmoticons:true,renderEmoji:true,text:aa});}z(i._("{actor} named the conversation: {name}.",[i.param('actor',fa),i.param('name',c('React').createElement('span',{className:ba},ga))]));}else z(i._("{actor} removed the conversation name.",[i.param('actor',fa)]));});}function v(x,y,z){if(x.author===c('MercuryViewer').getID()){!x.log_message_data?j(0):void 0;if(x.log_message_data.image){z(i._("You changed the conversation picture."));}else z(i._("You removed the conversation picture."));}else c('MercuryParticipants').get(x.author,function(aa){var ba=c('MercuryMessageRendererUtils').getLinkToParticipant(aa,y);!x.log_message_data?j(0):void 0;if(x.log_message_data.image){z(i._("{actor} changed the conversation picture.",[i.param('actor',ba)]));}else z(i._("{actor} removed the conversation picture.",[i.param('actor',ba)]));});}function w(x,y){if(x.author===c('MercuryViewer').getID()){y(i._("You changed the wallpaper."));}else c('MercuryParticipants').get(x.author,function(z){var aa=c('MercuryMessageRendererUtils').getLinkToParticipant(z);y(i._("{actor} changed the wallpaper.",[i.param('actor',aa)]));});}},null);
__d('MercuryMeMessageProcessor',['ImmutableObject','MercuryActionType','MercuryConfig','MercuryIDs','MercuryLogMessageType','MercuryParticipants','MercuryCommands'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(l){if(!l)return false;if(l.action_type!==c('MercuryActionType').USER_GENERATED_MESSAGE)return false;var m=l.body;return i(m);}function i(l){if(!c('MercuryConfig').MessengerRenderMeAsAdminMessageGK)return false;if(typeof l==='string'&&l.startsWith(c('MercuryCommands').ME))return true;return false;}function j(l,m,n,o){c('MercuryParticipants').get(m,function(p){o(k(l,p,n));});}function k(l,m,n){var o=c('MercuryIDs').getUserIDFromParticipantID(m.id),p=n.custom_nickname&&n.custom_nickname[o];p=p?p:m.short_name;return l.replace(c('MercuryCommands').ME,p+' ').replace(/\n+\s*\n+/g,'\n');}f.exports={transformSnippet:j,transformSnippetNow:k,shouldTransform:h,shouldTransformSnippet:i};},null);
__d('MercurySheetPolicy',['keyMirror'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={ChatThreadIsMutedTabSheet:{isPermanent:false,isSheetWithInput:false},ChatUserFocusSheet:{isPermanent:true,isSheetWithInput:false},ChatUserBlockedTabSheet:{isPermanent:true,isSheetWithInput:false},ChatUploadWarningTabSheet:{isPermanent:false,isSheetWithInput:false},ChatThreadSecretModeSheet:{isPermanent:true,isSheetWithInput:false},ChatThreadIsMessageBlockedSheet:{isPermanent:true,isSheetWithInput:false},ChatReadOnlyTabSheet:{isPermanent:false,isSheetWithInput:false},ChatReadOnlyPermanentTabSheet:{isPermanent:true,isSheetWithInput:false},ChatOfflineTabSheet:{isPermanent:true,isSheetWithInput:false},ChatNoRecipientsTabSheet:{isPermanent:true,isSheetWithInput:false},ChatNewMessagesTabSheet:{isPermanent:true,isSheetWithInput:true},ChatNameConversationTabSheet:{isPermanent:true,isSheetWithInput:true},ChatEmployeeAwaySheet:{isPermanent:true,isSheetWithInput:false},ChatPageResponsivenessIndicator:{isPermanent:true,isSheetWithInput:false}},i={canReplaceOpenSheet:function(j,k){var l=this.getType(k),m=this.isPermanent(k),n=this.isSheetWithInput(k),o=this.getType(j),p=this.isPermanent(j),q=this.isSheetWithInput(j);if(q)return !!(l!==o&&n);if(p&&!m)return false;if(o===this.sheets.ChatThreadIsMessageBlockedSheet)return false;return true;},getType:function(j){var k=j.getType||j.type&&j.type.getType||function(){return j;},l=k.call(j);return l;},isPermanent:function(j){if(typeof j==='string'&&h[j])return h[j].isPermanent;var k=j.isPermanent||j.type&&j.type.isPermanent||function(){return false;},l=k.call(j);return l;},isSheetWithInput:function(j){if(typeof j==='string'&&h[j])return h[j].isSheetWithInput;var k=j.isSheetWithInput||j.type&&j.type.isSheetWithInput||function(){return false;},l=k.call(j);return l;},sheets:c('keyMirror')(h)};f.exports=i;},null);
__d('MercuryMessageGroup',['MercuryActionType','MercuryAttachmentType','MercuryMeMessageProcessor','MercuryShareAttachmentRenderLocations','MercuryThreadlistConstants','enumerate'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={calculateMessageGroups:function(k,l){var m=[],n=null,o={value:null},p=c('enumerate')(k),q=void 0;while(!(q=p.next()).done){var r=h.canAppendMessageToLastGroup(o.value,q.value,l);if(!r){n=[];m.push(n);}n.push(q.value);o=q;}return m;},canAppendMessageToLastGroup:function(k,l,m){var n=c('MercuryThreadlistConstants').GROUPING_THRESHOLD;if(!k||i(k,m)||i(l,m)||k.author!=l.author||k.timestamp<l.timestamp-n||k.is_spoof_warning!==l.is_spoof_warning||k.page_admin_notes)return false;return true;}};function i(k,l){var m=k.has_attachment;if(m&&(l===c('MercuryShareAttachmentRenderLocations').MESSENGER||l===c('MercuryShareAttachmentRenderLocations').CHAT))m=j(k);return !!(k.action_type==c('MercuryActionType').LOG_MESSAGE||c('MercuryMeMessageProcessor').shouldTransform(k)||m||k.forward_count||k.html_body||k.body&&k.body.length>c('MercuryThreadlistConstants').MAX_CHARS_BEFORE_BREAK);}function j(k){var l=k.attachments[0];return (!l||l.attach_type===c('MercuryAttachmentType').STICKER||l.attach_type===c('MercuryAttachmentType').ANIMATED_IMAGE);}f.exports=h;},null);
__d('shouldAddMRefParam',['URI','isFacebookURI'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=function(i){if(!c('isFacebookURI')(i)||i.getFragment())return false;if(/^\/safetycheck\//.test(i.getPath()))return false;return true;};f.exports=h;},null);
__d('MessagingFlowerCornerArrangements',['invariant','ix','Random','randomShuffle'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j={TOP_LEFT:'topLeft',BOTTOM_RIGHT:'bottomRight'},k={PINK:'pink',PURPLE:'purple',YELLOW:'yellow'},l={ROUND:'round',POINTY:'pointy'},m=-10;function n(r,s){this.$ElementProducer1=r;this.$ElementProducer4=s;this.$ElementProducer2=c('Random').random()<.5;this.$ElementProducer3=[];var t=[k.PINK,k.PURPLE,k.YELLOW],u=[l.ROUND,l.POINTY,c('Random').random()>=.5?l.ROUND:l.POINTY];c('randomShuffle')(t);c('randomShuffle')(u);for(var v=0;v<3;v++)this.$ElementProducer3.push(this.$ElementProducer5(t[v],u[v]));}n.prototype.$ElementProducer6=function(r){switch(r){case k.PINK:return i('/images/messaging/flowerborder/pinkPointyFlower.png');case k.PURPLE:return i('/images/messaging/flowerborder/purplePointyFlower.png');case k.YELLOW:default:return i('/images/messaging/flowerborder/yellowPointyFlower.png');}};n.prototype.$ElementProducer7=function(r){switch(r){case k.PINK:return i('/images/messaging/flowerborder/pinkRoundFlower.png');case k.PURPLE:return i('/images/messaging/flowerborder/purpleRoundFlower.png');case k.YELLOW:default:return i('/images/messaging/flowerborder/yellowRoundFlower.png');}};n.prototype.$ElementProducer5=function(r,s){return s===l.POINTY?this.$ElementProducer6(r):this.$ElementProducer7(r);};n.prototype.$ElementProducer8=function(){return this.$ElementProducer3.pop();};n.prototype.flower=function(r){var s=c('Random').random()*360;return this.$ElementProducer9(this.$ElementProducer8(),{pivot:.5,rotationStart:s+r.rotationStartOffset,rotationEnd:s,scale:r.scale,x:r.x,y:r.y});};n.prototype.leaf=function(r){return this.$ElementProducer9(i('images/messaging/flowerborder/leaf.png'),{pivot:1,rotationStart:0,rotationEnd:r.rotationEnd,scale:r.scale,x:r.x,y:r.y});};n.prototype.$ElementProducer9=function(r,s){var t=s.pivot*100+'%',u=s.x+m,v=s.y+m,w=-s.pivot*100,x=s.scale,y=s.rotationEnd,z=void 0,aa=void 0,ba=void 0,ca=void 0;if(this.$ElementProducer2){var da=u;u=v;v=da;y=-y;}if(this.$ElementProducer1===j.BOTTOM_RIGHT){ca=this.$ElementProducer4+u+'px';aa=this.$ElementProducer4+v+'px';w=100+w;y+=180;}else if(this.$ElementProducer1===j.TOP_LEFT){ba=this.$ElementProducer4+u+'px';z=this.$ElementProducer4+v+'px';}else h(0);var ea=[];if(w!==0)ea.push('translate('+w+'%, '+w+'%)');ea.push('scale('+x+')');if(y!==0)ea.push('rotate('+y+'deg)');return {style:{bottom:aa,left:ba,position:'absolute',right:ca,top:z,transform:ea.join(' '),transformOrigin:t+' '+t},image:r};};function o(r){return [r.leaf({x:20.5,y:38,scale:.225,rotationEnd:-80}),r.leaf({x:29,y:22.5,scale:.35,rotationEnd:35}),r.flower({x:31.5,y:22,scale:.6,rotationStartOffset:-70}),r.flower({x:21,y:35,scale:.65,rotationStartOffset:-70}),r.flower({x:21.75,y:24.75,scale:1,rotationStartOffset:50})];}function p(r){return [r.leaf({x:22.25,y:35.25,scale:.225,rotationEnd:-115}),r.leaf({x:35,y:24,scale:.35,rotationEnd:110}),r.flower({x:21.5,y:32.5,scale:.68,rotationStartOffset:-60}),r.flower({x:21.5,y:23.5,scale:.67,rotationStartOffset:-70}),r.flower({x:31,y:21,scale:.95,rotationStartOffset:50})];}function q(r,s){var t=new n(r,s);return c('Random').random()<.5?o(t):p(t);}f.exports={createFlowers:q,corners:j};},null);
__d('MessagingFlowerBorder.react',['Image.react','MessagingFlowerCornerArrangements','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=c('React').createClass({displayName:'MessagingFlowerBorder',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{ChildClass:h.number},getDefaultProps:function(){return {offset:0};},getInitialState:function(){return {elements:this._createElements()};},_createElements:function(){return c('MessagingFlowerCornerArrangements').createFlowers(c('MessagingFlowerCornerArrangements').corners.TOP_LEFT,this.props.offset).concat(c('MessagingFlowerCornerArrangements').createFlowers(c('MessagingFlowerCornerArrangements').corners.BOTTOM_RIGHT,this.props.offset));},render:function(){return (c('React').createElement('div',null,this.state.elements.map(function(j,k){return c('React').createElement(c('Image.react'),{key:k,style:j.style,src:j.image});})));}});f.exports=i;},null);
__d('MessagingGiftWrap.react',['cx','CurrentEnvironment','ReactComponentWithPureRenderMixin','React','emptyFunction'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'MessagingGiftWrap',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{isSticker:i.bool,onUnwrap:i.func},getDefaultProps:function(){return {onUnwrap:c('emptyFunction')};},getInitialState:function(){return {unwrapped:false};},render:function(){var k=c('CurrentEnvironment').messengerdotcom;return (c('React').createElement('div',{className:"_4p0m"+(this.state.unwrapped?' '+"_4p0o":'')+(k?' '+"_mxz":'')+(k?' '+"_4br2":'')+(!k?' '+"_3_om":'')+(this.props.isSticker?' '+"_52vq":''),onClick:this._handleClick},c('React').createElement('div',{className:"_4p0r"}),c('React').createElement('div',{className:"_4p0s _4p0t"}),c('React').createElement('div',{className:"_4p0s _4p0u"})));},_handleClick:function(k){k.stopPropagation();this.setState({unwrapped:true});this.props.onUnwrap&&this.props.onUnwrap();}});f.exports=j;},null);
__d('P2PAbstractSendMoneyButton.react',['cx','fbt','React','TooltipLink.react','joinClasses'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=c('React').createClass({displayName:'P2PAbstractSendMoneyButton',propTypes:{button:j.object,isActive:j.bool.isRequired,isDisabled:j.bool,isMessenger:j.bool.isRequired,onClick:j.func.isRequired,onMouseOver:j.func,recipientName:j.string},_clickGuard:false,render:function(){return (c('React').createElement(c('TooltipLink.react'),{alignH:'center',className:c('joinClasses')(this.props.className,(this.props.isActive?"open":'')+(this.props.isDisabled?' '+"disabled":'')+(this.props.isActive?' '+"_10gz":'')+(this.props.isDisabled?' '+"_10g-":'')+(!this.props.isMessenger&&!this.props.className?' '+"_5uqy":'')+(this.props.isMessenger?' '+"_3ggc":'')),href:'#',onClick:this._handleClick,onMouseDown:this._prepareForClick,onMouseOver:this.props.onMouseOver,position:'above',role:'button',title:this._getLinkTitle()},this.getButton()));},getButton:function(){if(this.props.button)return this.props.button;return c('React').createElement('i',{className:"_5s8l"});},_getLinkTitle:function(){if(this.props.isDisabled)return null;return i._("Send money");},_prepareForClick:function(){this.props.onMouseDown&&this.props.onMouseDown();this._clickGuard=this.props.isActive;},_handleClick:function(l){l.stopPropagation();if(this._clickGuard){this._clickGuard=false;return;}this.props.onClick();}});f.exports=k;},null);
__d('P2PSendMoneyContainerBootloader.react',['cx','Bootloader','CurrentEnvironment','DeferredComponent.react','MercuryIDs','P2PAbstractSendMoneyButton.react','P2PActions','P2PLoadingMask.react','P2PLogger','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','P2PSendMoneyDialogStore','React','ReactLayeredComponentMixin','ReactDOM','Run','XUIContextualDialog.react','emptyFunction'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('CurrentEnvironment').messengerdotcom,k=j?282:260,l=c('React').createClass({displayName:'P2PSendMoneyContainerBootloader',propTypes:{button:i.node,className:i.string,ContextualDialog:i.func,flyoutAlignment:i.string,onTrigger:i.func,participantIDs:i.array,referrer:i.string,threadID:i.string},getInitialState:function(){return {showPlaceholderDialog:false,shouldBootloadImmediately:c('P2PSendMoneyDialogStore').isAnyChatSendViewOpen()};},mixins:[c('ReactLayeredComponentMixin')],_clicked:false,_onComponentLoad:c('emptyFunction'),_bootloadCalled:false,_sendMoneyDialogStoreSub:null,log:function(m,n){c('P2PLogger').log(m,babelHelpers['extends']({www_event_referrer:this.props.referrer,www_event_flow:c('P2PPaymentLoggerEventFlow').UI_FLOW_P2P_SEND},n));},componentWillMount:function(){if(this.state.shouldBootloadImmediately){this._bootloadComponentNow();}else this._sendMoneyDialogStoreSub=c('P2PSendMoneyDialogStore').addListener('change',this.onDialogStoreChange);},componentWillUnmount:function(){this.removeDialogStoreSub();},onDialogStoreChange:function(){this._bootloadComponentNow();this.removeDialogStoreSub();},removeDialogStoreSub:function(){if(this._sendMoneyDialogStoreSub){this._sendMoneyDialogStoreSub.remove();this._sendMoneyDialogStoreSub=null;}},onPlaceholderClick:function(){var m=this.props.threadID?c('MercuryIDs').tokenize(this.props.threadID).value:null;this._handleDialogVisibility(!this.state.showPlaceholderDialog);this.log(c('P2PPaymentLoggerEvent').UI_ACTN_SEND_MONEY_BUTTON_PLACEHOLDER_CLICKED,{object_id:m});this._bootloadComponentNow();this._clicked=false;},_handleDialogVisibility:function(m){if(!m){c('P2PActions').chatSendViewClosed({threadID:this.props.threadID});}else c('P2PActions').chatSendViewOpened({referrer:this.props.referrer,threadID:this.props.threadID});this.setState({showPlaceholderDialog:m});},renderLayers:function(){var m={};if(this.state.showPlaceholderDialog){var n=this.props.ContextualDialog||c('XUIContextualDialog.react');m.placeholderDialog=c('React').createElement(n,{alignment:this.props.flyoutAlignment?this.props.flyoutAlignment:j?'right':'left',context:c('ReactDOM').findDOMNode(this.refs.placeholderButton),onBlur:function(){if(!this._clicked)this._handleDialogVisibility(false);this._clicked=false;}.bind(this),ref:'dialog',shown:true,width:k,position:'above'},c('React').createElement('div',{className:"_c_5"},c('React').createElement(c('P2PLoadingMask.react'),{visible:true})));}return m;},render:function(){return (c('React').createElement(c('DeferredComponent.react'),babelHelpers['extends']({deferredComponent:this._bootloadComponent,deferredPlaceholder:this._renderPlaceholder()},this.props)));},_renderPlaceholder:function(){return (c('React').createElement(c('P2PAbstractSendMoneyButton.react'),{button:this.props.button,className:this.props.className,isActive:false,isDisabled:false,isMessenger:j,onClick:this.onPlaceholderClick,onMouseDown:function(){return this._clicked=true;}.bind(this),onMouseOver:this._bootloadComponentNow,ref:'placeholderButton'}));},_bootloadComponent:function(m){this._onComponentLoad=m.bind(this);},_bootloadComponentNow:function(){if(this._bootloadCalled)return;this._bootloadCalled=true;c('Bootloader').loadModules(["P2PSendMoneyContainer.react"],function(m){this.removeDialogStoreSub();this._onComponentLoad(m);this.setState({showPlaceholderDialog:false});}.bind(this),'P2PSendMoneyContainerBootloader.react');}});f.exports=l;},null);
__d('StickersDispatcher',['Dispatcher_DEPRECATED','StickerConstants'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=Object.assign(new (c('Dispatcher_DEPRECATED'))(),{_handleUpdate:function(i,j){var k=babelHelpers['extends']({payloadSource:i},j);this.dispatch(k);},handleUpdateFromViewActions:function(i){this._handleUpdate(c('StickerConstants').PayloadSource.VIEW_ACTION,i);}});f.exports=h;},null);
__d('StickerActions',['BanzaiLogger','StickersDispatcher','keyMirror'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('keyMirror')({ADD_PACK:null,CLICKED_STICKER_IN_THREAD:null,HIDE_TRAY:null,REMOVE_PACK:null,REPLACE_STICKER_STATE:null,RESET_NUM_NEW_PACKS:null,SELECT_PACK:null,SELECT_STORE_PACK:null,SHOW_TRAY:null,UPDATE_TRAY_DATA:null,TRAY_DATA_READY:null,SUBSCRIBE_ASSOCIATED_PAGE:null}),i={Types:h,addPack:function(j){c('StickersDispatcher').dispatch({type:h.ADD_PACK,packID:j});},removePack:function(j){c('StickersDispatcher').dispatch({type:h.REMOVE_PACK,packID:j});},selectPack:function(j,k){if(!k)c('BanzaiLogger').log('StickersLoggerConfig',{event:'select_pack',packid:j});c('StickersDispatcher').dispatch({type:h.SELECT_PACK,packID:j});},selectStorePack:function(j){c('StickersDispatcher').dispatch({type:h.SELECT_STORE_PACK,packID:j});},resetNumNewPacks:function(){c('StickersDispatcher').dispatch({type:h.RESET_NUM_NEW_PACKS});},handleStickerClick:function(j,k){c('StickersDispatcher').dispatch({packID:j,threadID:k,type:i.Types.CLICKED_STICKER_IN_THREAD});},showStickerTray:function(j){c('StickersDispatcher').dispatch({type:i.Types.SHOW_TRAY,threadID:j});},hideStickerTray:function(){c('StickersDispatcher').dispatch({type:i.Types.HIDE_TRAY});},updateTrayData:function(){c('StickersDispatcher').dispatch({type:i.Types.UPDATE_TRAY_DATA});},loadedTrayData:function(){c('StickersDispatcher').dispatch({type:i.Types.TRAY_DATA_READY});},subscribeAssociatedPage:function(j,k){c('StickersDispatcher').dispatch({type:i.Types.SUBSCRIBE_ASSOCIATED_PAGE,packID:j,callback:k});}};f.exports=i;},null);
__d("XMNStickerAssociatedPageSubscriptionController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/messages\/commerce\/stickers\/subscription\/",{pack_id:{type:"FBID"}});},null);
__d("XStickerPackImagesController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/{pack_id}\/images\/",{pack_id:{type:"Int",required:true},sticker_size:{type:"Int",defaultValue:50}});},null);
__d("XStickerQueryImagesController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/query\/images\/",{query:{type:"String",required:true},sticker_interface:{type:"String"}});},null);
__d("XStickerStateInitialDataController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/state\/",{});},null);
__d("XStickerStatePackDataController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/state\/pack\/",{pack_id:{type:"Int",required:true}});},null);
__d("XStickerStateStoreDataController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/state\/store\/",{});},null);
__d("XStickersAddPackController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/addpack\/",{pack_id:{type:"Int"},size:{type:"String"},redirect_uri:{type:"String"},is_promoted:{type:"Bool",defaultValue:false},no_async_dom:{type:"Bool",defaultValue:false}});},null);
__d("XStickersRemovePackController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/removepack\/",{pack_id:{type:"Int"},size:{type:"String"},redirect_uri:{type:"String"},no_async_dom:{type:"Bool",defaultValue:false}});},null);
__d('StickerServerRequests',['Promise','AsyncRequest','XMNStickerAssociatedPageSubscriptionController','XStickerPackImagesController','XStickersAddPackController','XStickersRemovePackController','XStickerStateInitialDataController','XStickerStatePackDataController','XStickerStateStoreDataController','XStickerQueryImagesController'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={addPack:function(j,k,l){var m=c('XStickersAddPackController').getURIBuilder().setInt('pack_id',j).setBool('is_promoted',k).getURI();new (c('AsyncRequest'))(m).setHandler(function(n){return l(n.payload);}).send();},removePack:function(j,k){var l=c('XStickersRemovePackController').getURIBuilder().setInt('pack_id',j).getURI();new (c('AsyncRequest'))(l).setHandler(function(m){return k(m.payload);}).send();},getStickersForPack:function(j,k){var l=c('XStickerPackImagesController').getURIBuilder().setInt('pack_id',j).setInt('sticker_size',k).getURI();return new (c('Promise'))(function(m,n){return (new (c('AsyncRequest'))().setURI(l).setMethod('GET').setReadOnly(true).setHandler(function(o){return m(o.payload);}).send());});},getStickersForQuery:function(j,k,l){new (c('AsyncRequest'))().setURI(c('XStickerQueryImagesController').getURIBuilder().setString('query',j).setString('sticker_interface',k).getURI()).setMethod('GET').setReadOnly(true).setHandler(function(m){return l(m);}).send();},fetchTrayData:function(j){return i(c('XStickerStateInitialDataController').getURIBuilder().getURI(),j,true);},fetchStoreData:function(j){return i(c('XStickerStateStoreDataController').getURIBuilder().getURI(),j);},fetchPackData:function(j,k){return i(c('XStickerStatePackDataController').getURIBuilder().setInt('pack_id',j).getURI(),k);},subscribeAssociatedPage:function(j,k){var l=c('XMNStickerAssociatedPageSubscriptionController').getURIBuilder().setFBID('pack_id',j).getURI();new (c('AsyncRequest'))(l).setHandler(function(m){return k();}).send();}};function i(j,k,l){return new (c('Promise'))(function(m,n){return (new (c('AsyncRequest'))(j).setHandler(function(o){return m(o.getPayload());}).setAllowCrossPageTransition(l).send());}).then(k);}f.exports=h;},null);
__d('StickerImages',['StickerServerRequests'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={},i={},j={requestStickersForPack:function(k,l,m){if(!k)return;if(!i[k]){i[k]=c('StickerServerRequests').getStickersForPack(k,l);i[k].then(function(n){n.forEach(function(o){return this.cacheSticker(o);}.bind(this));}.bind(this));}i[k].then(function(n){return m(n);});},cacheSticker:function(k){h[k.id]=k;},getSticker:function(k){return h[k];}};f.exports=j;},null);
__d('StickerState',['ImmutableObject','PresenceState','StickerActions','StickerConstants','StickerImages','StickerServerRequests'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={},i=void 0,j=void 0,k=void 0,l=null,m=0,n={},o=[],p=[],q=[],r=null,s=null,t=c('PresenceState').get();if(t)r=t.tray_pack_id;var u={onTrayDataReady:function(w){if(!j)j=c('StickerServerRequests').fetchTrayData(function(x){o=x.packs.map(function(y){return v(y);});k=x.mru;m=x.num_new_packs;q=x.tags;});j.then(function(){w();c('StickerActions').loadedTrayData();});},onStoreDataReady:function(w){if(!i)i=c('StickerServerRequests').fetchStoreData(function(x){p=x.packs.map(function(y){return v(y);});});i.then(w);},onPackDataReady:function(w,x){if(!h[w])h[w]=c('StickerServerRequests').fetchPackData(w,function(y){v(y);});h[w].then(x);},getPacksInTrayAllInterfaces:function(){return o;},getPacksInTray:function(){var w=[],x=void 0;for(var y=0;y<o.length;y++)if(o[y].id==c('StickerConstants').EMOTICON_PACK_ID){x=o[y];}else if(o[y].isMessengerCapable)w.push(o[y]);x&&w.push(x);return w;},getPacksInCommentsTray:function(){var w=[],x=[],y=void 0;for(var z=0;z<o.length;z++)if(o[z].id==c('StickerConstants').EMOTICON_PACK_ID){y=o[z];}else if(o[z].isCommentsCapable){w.push(o[z]);}else x.push(o[z]);var aa=w.concat(x);if(y)aa.push(y);return aa;},getPacksInComposerTray:function(){return o.filter(function(w){return w.isComposerCapable;});},getPacksInFramesTray:function(){return o.filter(function(w){return w.isFramePack;});},getPackIDsInTray:function(){return o.map(function(w){return w.id;});},getPacksInStore:function(){return p.filter(function(w){return w.isMessengerCapable;});},getComposerPacksInStore:function(){return p.filter(function(w){return w.isComposerCapable;});},getPack:function(w){return n[w];},getNumNewPacks:function(){return m;},getFeaturedTags:function(){return q;},resetNumNewPacks:function(){m=0;},addMRUPack:function(){if(k){this._addPackToTray(k);k=null;}},addPack:function(w){var x=false;if(n[w])x=n[w].isPromoted;c('StickerServerRequests').addPack(w,x,function(y){this._addPackToTray(y);}.bind(this));},removePack:function(w){c('StickerServerRequests').removePack(w,function(x){o=o.filter(function(y){return y.id!==x;});n[x]=c('ImmutableObject').set(n[x],{isInTray:false});p=p.map(function(y){return n[y.id];});c('StickerActions').updateTrayData();});},setTrayPackID:function(w){r=w;c('PresenceState').doSync();},getTrayPackID:function(w){if(w&&w.length>0&&!w.some(function(x){return x.id===r;})){return w[0].id;}else return r;},setStorePackID:function(w){s=w;},getStorePackID:function(){return s;},subscribeAssociatedPage:function(w,x){c('StickerServerRequests').subscribeAssociatedPage(w,function(){n[w]=c('ImmutableObject').set(n[w],{isAssociatedPageSubscribed:true});p=p.map(function(y){return n[y.id];});c('StickerActions').updateTrayData();x();});},_addPackToTray:function(w,x){v(w);n[w.id]=c('ImmutableObject').set(n[w.id],{isPurchased:!x,isInTray:true});var y=o.filter(function(aa){return aa.id===w.id;}).length>0;if(!y){var z=void 0;if(!x){z=o.filter(function(aa){return aa.isMRU||aa.isSearch;}).length;}else z=o.filter(function(aa){return aa.id!==c('StickerConstants').EMOTICON_PACK_ID;}).length;o.splice(z,0,n[w.id]);}p=p.map(function(aa){return n[aa.id];});c('StickerActions').updateTrayData();},_addRecentlyUsedSticker:function(w){for(var x=0;x<l.length;++x)if(l[x].id===w.id){l.splice(x,1);break;}l.unshift(w);},getMRUStickerPack:function(w){if(!l)l=w;return l;},updateRecentlyUsed:function(w){if(!l){this.addMRUPack();return;}this._addRecentlyUsedSticker(c('StickerImages').getSticker(w));}};c('PresenceState').registerStateStorer(function(w){w.tray_pack_id=r;});function v(w){var x=w.id;if(!n[x]){return n[x]=new (c('ImmutableObject'))(w);}else return n[x]=c('ImmutableObject').set(n[x],w);}f.exports=u;},null);
__d('DialogFitHeight',['AbstractDialogFitHeight'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('AbstractDialogFitHeight'));i=h&&h.prototype;j.prototype.getHeightProperty=function(){'use strict';return 'height';};function j(){'use strict';h.apply(this,arguments);}f.exports=j;},null);
__d('StickerStoreController',['cx','Bootloader','DialogFitHeight','DOM','LayerAutoFocus','LayerFadeOnHide','LayerHideOnEscape','React','ReactComponentRenderer','StickerActions','XUIDialog.react','XUIDialogBody.react','XUISpinner.react','isSocialPlugin','requestAnimationFrame'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=688,k=320,l=null,m=c('React').createClass({displayName:'StoreLayer',propTypes:{isComposer:i.bool,shown:i.bool},getDefaultProps:function(){return {isComposer:false,shown:false};},getInitialState:function(){return {renderStore:function(){return (c('React').createElement('div',{className:"_5r5e"},c('React').createElement(c('XUISpinner.react'),{background:'light',size:'large'})));}};},componentDidMount:function(){c('Bootloader').loadModules(["StickerStore.react"],function(p){this.setState({renderStore:function(){return (c('React').createElement(p,{isComposer:this.props.isComposer,shown:this.props.shown}));}.bind(this)});}.bind(this),'StickerStoreController');},_onToggle:function(p){c('requestAnimationFrame')(function(){if(l)l.setProps({shown:p});});},render:function(){var p=c('isSocialPlugin')()&&document.body.offsetWidth<j?k:j;return (c('React').createElement(c('XUIDialog.react'),{behaviors:{DialogFitHeight:c('DialogFitHeight'),LayerAutoFocus:c('LayerAutoFocus'),LayerFadeOnHide:c('LayerFadeOnHide'),LayerHideOnEscape:c('LayerHideOnEscape')},onToggle:this._onToggle,shown:this.props.shown,width:p},c('React').createElement(c('XUIDialogBody.react'),{className:"_5rq- autofocus"},this.state.renderStore())));}});function n(p){var q=c('DOM').create('div');c('DOM').appendContent(document.body,q);l=new (c('ReactComponentRenderer'))(m,q);l.setProps({isComposer:p,shown:true});}var o={showStore:function(p,q){if(!l){n(!!q);}else l.setProps({shown:true,isComposer:!!q});c('StickerActions').selectStorePack(p);}};f.exports=o;},null);
__d('StickerStateStore',['FluxStore','StickerActions','StickerInterfaces','StickersDispatcher','StickerState','StickerStoreController','arrayContains','emptyFunction'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('FluxStore'));i=h&&h.prototype;function j(){i.constructor.call(this,c('StickersDispatcher'));this.$StickerStateStore3=false;}j.prototype.getState=function(k){var l=null;if(k===c('StickerInterfaces').COMPOSER){l=c('StickerState').getPacksInComposerTray();}else if(k===c('StickerInterfaces').COMMENTS){l=c('StickerState').getPacksInCommentsTray();}else if(k===c('StickerInterfaces').FRAMES){l=c('StickerState').getPacksInFramesTray();}else l=c('StickerState').getPacksInTray();return {showTray:this.$StickerStateStore1,storePackID:c('StickerState').getStorePackID(),packID:c('StickerState').getTrayPackID(l),trayPacks:l,numNewPacks:c('StickerState').getNumNewPacks(),threadID:this.$StickerStateStore2,trayDataReady:this.$StickerStateStore3};};j.prototype.isPackInTray=function(k){if(!this.$StickerStateStore3)c('StickerState').onTrayDataReady(c('emptyFunction'));var l=c('StickerState').getPacksInTrayAllInterfaces();return l.some(function(m){return m.id===k;});};j.prototype.isPackPageSubscribed=function(k){if(!this.$StickerStateStore3)c('StickerState').onTrayDataReady(c('emptyFunction'));var l=c('StickerState').getPacksInTrayAllInterfaces();return l.some(function(m){return m.id===k&&m.isAssociatedPageSubscribed;});};j.prototype.__onDispatch=function(k){var l=c('StickerActions').Types;switch(k.type){case l.REPLACE_STICKER_STATE:this.$StickerStateStore1=!!k.showTray;break;case l.SHOW_TRAY:this.$StickerStateStore1=true;this.$StickerStateStore2=k.threadID;break;case l.HIDE_TRAY:this.$StickerStateStore1=false;break;case l.CLICKED_STICKER_IN_THREAD:c('StickerState').onTrayDataReady(function(){if(c('arrayContains')(c('StickerState').getPackIDsInTray(),k.packID)){c('StickerState').setTrayPackID(k.packID);this.$StickerStateStore1=true;this.$StickerStateStore2=k.threadID;}else{this.$StickerStateStore1=false;c('StickerStoreController').showStore(k.packID);}}.bind(this));break;case l.SELECT_PACK:c('StickerState').setTrayPackID(k.packID);break;case l.SELECT_STORE_PACK:c('StickerState').setStorePackID(k.packID);break;case l.RESET_NUM_NEW_PACKS:c('StickerState').resetNumNewPacks();break;case l.ADD_PACK:c('StickerState').addPack(k.packID);break;case l.REMOVE_PACK:c('StickerState').removePack(k.packID);break;case l.UPDATE_TRAY_DATA:break;case l.TRAY_DATA_READY:this.$StickerStateStore3=true;break;case l.SUBSCRIBE_ASSOCIATED_PAGE:c('StickerState').subscribeAssociatedPage(k.packID,k.callback);break;}this.__emitChange();};f.exports=new j();},null);